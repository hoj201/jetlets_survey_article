\documentclass[12pt]{amsart}
\usepackage[margin=1in]{geometry}
\usepackage{amssymb}
\usepackage{stmaryrd}
\usepackage{mathrsfs}
\usepackage{graphicx}
\usepackage{tikz}
\usetikzlibrary{arrows}
\usetikzlibrary{matrix}
\usetikzlibrary{cd}
\usepackage{todonotes}
\usepackage{hyperref}
\usepackage{url}

\usepackage{tensor}

\newcommand{\hoj}[1]{\todo[inline,color=blue!20]{HOJ: #1}}
\newcommand{\cjc}[1]{\todo[inline,color=red!20]{CJC:  #1}}
\newcommand{\je}[1]{\todo[inline,color=green!20]{JE:  #1}}
\newcommand{\dm}[1]{\todo[inline,color=yellow!20]{DM:  #1}}

\newcommand{\pder}[2]{\ensuremath{\frac{\partial #1}{\partial #2}}}
\newcommand{\so}{\ensuremath{\mathfrak{so}}}
\newcommand{\R}{\ensuremath{\mathbb{R}}}

\newtheorem{thm}{Theorem}[section]
\newtheorem{prop}[thm]{Proposition}
\newtheorem{lem}[thm]{Lemma}
\newtheorem{cor}[thm]{Corollary}
\newtheorem{defn}[thm]{Definition}

\DeclareMathOperator{\SDiff}{SDiff}
\DeclareMathOperator{\Diff}{Diff}
\DeclareMathOperator{\Jet}{Jet}
\DeclareMathOperator{\SO}{SO}
\DeclareMathOperator{\SL}{SL}
\DeclareMathOperator{\tr}{tr}
\DeclareMathOperator{\iso}{iso}
\DeclareMathOperator{\kernel}{kernel}
\DeclareMathOperator{\bag}{bag}
\DeclareMathOperator{\lie}{\mathcal{L}}
\DeclareMathOperator{\ad}{ad}

\title{TITLE}

\author{C.J. Cotter, J. Eldering, D. D. Holm, H. O. Jacobs, D. M. Meier}

\begin{document}

\maketitle

\begin{abstract}
  \todo[inline]{Still need to write this}
\end{abstract}

\section{Introduction}
blah blah blah
\hoj{During the group meeting I said something like
  \emph{The foundations of the representation theory of Diff(M) is the jet groups.  As such it would seem natural to invoke these foundations
  in the context of fluids, where the configuation manifold is Diff(M).}
  Jaap and Darryl thought this served as a good ``disclaimer'', 
  which conveyed that our paper is more foundational.
  }
\hoj{This is the old intro.  It can be trashed}
The self similarity of ideal fluids
yields the notorious ``cascade to smaller scales'',
providing a raison d'\^{e}tre
for multiscale fluid modelling.
Moreover, self similarity is widely regarded as the cause
behind the great difficulties in proving well-posedness of 
the Navier-Stokes equations \cite{KatzPavlovic2005}.
This picture is summarized in the famous poem by Lewis Fry Richardson:
\begin{quote}
  Big whirls have little whirls,\\
  That feed on their velocity;\\
  And little whirls have lesser whirls,\\
  And so on to viscosity.
\end{quote}
Therefore, it would be useful to have a model of self-similarity
and cascade to obtain a better understanding of the structures involved.
In particular we would like to emphasize here the word \emph{model}.
Many years have been devoted to improving the numerical accuracy of computational fluid
schemes.
In this paper we will pursue a different target, that of ``structural'' accuracy.
In particular, we will propose a low dimensional toy model of self-similarity and cascade phenomena.
It is possible this model serves as an accurate numerical scheme for ideal fluids as certain parameters 
approach zero and infinity, but no attempt will be made in the present paper to rigorously examine this 
possibility.
It is a ``model'' in the sense that it pushes towards greater understanding as a primary goal,
and accuracy as a secondary goal.

\subsection{Main contributions}
In this article we derive a hierarchy of particle-like
solutions to a regularized model of ideal fluids.
Each method in the heirarchy consists of particles
with internal group variables, parametrized by
a finite dimensional model of a diffeomorphism group,
known as a jet group.
As the configuration manifold of a fluid is the space of
volume preserving diffeomorphisms, these particle-like solutions
paint an intuitive picture of a ``large'' diffeomorphism that advect particles,
each of which carries a ``small'' diffeomorphism.
Therefore, we propose these particle-like solutions as toy models
of diffeomorphism self-similarity.

  Toy models such as this are crucial to our understanding of fluids,
  both from a numerical perspective, and from the perspective
  of ``pure'' mathematics.
  Without models which mimic aspects of self-similarity 
  and cascade,
  one is forced to stare self-similarity in the face directly.
  Here we present one of the first Lagrangian models that reflects aspects
  of the self-similarity of ideal fluids.

More specifically, we will accomplish the following:
\begin{enumerate}
  \item We provide the first explicit Hamiltonian description of the full hierarchy of particle-like solutions discovered in 
  	\cite{JacobsRatiuDesbrun2013,CotterHolmJacobsMeier2014}.
  \item We will compute a nested sequence of conserved quantities at 
    each level in the hierarchy.
    Each of these conserved quantities will be related to the conservation
    of circulation.
  \item We will numerically compute some particle-like solutions at the the zeroth, first, and second levels in the hierarchy.  We will observe a form of cascade in which solutions at the $k^{\rm th}$ level asymptotically approach
    solutions at the $(k+1)^{\rm th}$ level.
\je{We don't do the second level. Probably we should say
  a little bit about this cascade\ldots}
\end{enumerate}


\subsection{Previous work}
  Lagrangian models of ideal fluids such as \emph{smooth particle hydrodynamics} \cite{Monaghan1977,Lucy1977} and
\emph{vortex methods} \cite{Chorin1973}, do not exhibit structures which express the nested character of the diffeomorphism group.
 One means of obtaining a Lagrangian model with a nested structure
 was recently presented in \cite{JacobsRatiuDesbrun2013}
 where a sequence of infinite-dimensional reductions by symmetry were
 executed, to produce a hierarchy of finite dimensional systems from a
 regularized fluid model.
 The finite dimensional systems were particle-like solutions
 in which each particle carries a model of the diffeomorphism group,
 known as jet groups.
 Thus \cite{JacobsRatiuDesbrun2013} derived a Lagrangian analog of 
 ``whirls within whirls'', similar to the Eulerian models proposed
 in \cite{HolmTronci2012}.
 However, the specifics of the regularized fluid model were not determined,
 and the analysis of \cite{JacobsRatiuDesbrun2013} was purely
 theoretical.
 
 Later, a regularized version of the ideal fluid equations was presented by
 \cite{MumfordMichor2013}.
 This new partial differential equation was amenable to the theory presented in 
 \cite{JacobsRatiuDesbrun2013}, and gave a specific and easily
 implementable manifestation of the hierarchy of particle models
 described there.
 In \cite{CotterHolmJacobsMeier2014} we numerically computed some
 of these particle-like solutions and observed cascade phenomena as
 an emergent behavior at the $0$th level in the hierarchy.

 It is notable that the $0$th level of the hierarchy has been studied
 for a long time in the context of partial differential equations with hydrodynamic background.
 In particular, \cite{HoldenRaynaud2006} provide the first convergence proof of such a method in the context of the Camassa-Holm equation.
 This same idea was implemented for the $n$-dimensional Camassa-Holm
 equation in \cite{ChertockDuToitMarsden2012}.
 In the context of image-registration algorithms, the need to obtain 
 compressible diffeomorphisms motivated the use of particle methods
 in a similar framework \cite{JoshiMiller2000}.
 These methods, designed for a wide array of PDE's are studied analytically
 in \cite{TrouveYounes2005} which also contains a proof of well-posedness
 for a range of PDE's.
 Finally, in the context of image registration, \cite{Sommer2013} 
 discovered a compressible fluid version of the hierarchy derived in \cite{JacobsRatiuDesbrun2013},
 and numerically integrates solutions in the first level of the hierarchy.

\subsection{Notation}
tangent bundle, cotangent bundle, vector field, contraction, Lie derivative,
smooth, continuous functions, group actions, infinitesimal generators,
dual spaces.  A group $G$, left multiplication $L_g$, right multi $R_g$, 
left/right action $\rho(g,x)$ or $\rho(x,g)$, infinitesimal generator $\rho(\xi,x)$ or $\rho(x,\xi)$.

Various different types of indices will be used throughout this paper.
To distinguish between the types, we keep the following
conventions:
\begin{itemize}
\item indices $a,b,c,\ldots$ label particles and range from $1$ to $N$;
\item indices $i,j,k,\ldots$ label space coordinates and range from
  $1$ to $n$, the dimension of space;
\item superscript indices $(k)$ denote the order of jets in a
  coordinate-free representation.
\end{itemize}

\todo[inline]{Finish this section}



\section{Main approach}
\label{sec:approach}
In this section we describe our strategy for obtaining
particle-like solutions to regularized fluid equations.
Our main framework is that of Hamiltonian mechanics
and symplectic geometry.
In particular, our main hammer is Theorem \ref{thm:dual_pairs} (see page 
\pageref{thm:dual_pairs} in the Appendix), which we repeat
here for convenience.
  \begin{quote}
    {\bf Theorem \ref{thm:dual_pairs}}
    Let $P_1$ and $P_2$ be Poisson manifolds and let $S$ be
    a symplectic manifold.  Let $J_1,J_2:S \to P_1,P_2$ form a dual pair 
    (see definition on page \pageref{thm:dual_pairs}).
    Let $h \in C^2(P_1)$.
    If $(q,p)(t) \in S$ is a solution to Hamilton's equations
    with respect to the Hamiltonian $H = h \circ J_1$,
    then $J_1\left( (q,p)(t) \right) \in P_1$ is a solution
    to Hamilton's equations on $P_1$ with respect to $h$,
    and $J_2( (q,p)(t))$ is constant in time.
  \end{quote}

We will leverage this theorem in the following way.
We will find a dual pair, $J_1,J_2: S \to \mathfrak{g}^*$, where
\begin{enumerate}
\item $S$ is the space of particle locations and momenta (and, for the higher orders of the hierarchy, internal group variables),
\item $\mathfrak{g}$ is the space of vector-fields,
\item and $h$ is the Hamiltonian of a regularized model of ideal fluid (i.e.\ a kinetic energy).
\end{enumerate}
Theorem~\ref{thm:dual_pairs} applied to the dual pair $J_1,J_2$
then yields particle-like solutions and conserved quantities to the equations of motion
of a regularized model of an ideal incompressible fluid.

\section{Example: the rigid body}
\label{sec:rigid_body}
  In this section we review basic notions from classical mechanics
by studying the motion of a rigid body whose center of mass rests
at the origin.
We will see a first application of Theorem \ref{thm:dual_pairs}
in this context.
The configuration of a rigid body is described by a
rotation matrix $R \in \SO(3)$.
The equations of motion are given by Hamilton's equations
on the cotangent bundle $T^*\SO(3)$.
There are canonical coordinates on $T^*\SO(3)$ given by $(R,P)$
where $P$ is such that $R^TP $ is a $3 \times 3$ anti-symmetric
matrix\footnote{%
  We use the pairing $\langle P, v \rangle = \tr(P^T v)$ for
  $P \in T^*_R SO(3)$ and $v \in T_R SO(3)$. More generally, the pairing $\langle \cdot , \cdot \rangle$ will always refer to the natural pairing between a vector-space and its dual in this paper.}.
The angular momentum in the body frame is the
unique vector $\Pi \in \mathbb{R}^3 \equiv \so(3)^*$ such that
\begin{align*}
  J_R(R,P) := R^TP = \begin{bmatrix}
    0 & -\Pi_3 & \Pi_2 \\
    \Pi_3 & 0 & -\Pi_1 \\
    -\Pi_2 & \Pi_1 & 0 
    \end{bmatrix}.
\end{align*}
Denoting this map from $(R,P)$ to $\Pi$ by $J_R$,
the Hamiltonian can be written as a function
of $\Pi$.  In particular, the reduced Hamiltonian is
\begin{align*}
  h(\Pi) = \frac{1}{2}\Pi \cdot \mathbb{I}^{-1} \cdot \Pi
\end{align*}
where $\mathbb{I}$ is a non-degenerate $3\times 3$ symmetric matrix
known as the moment of inertia matrix.
The unreduced Hamiltonian is $H(R,P) = h(J_R(R,P))$.

  The group $\SO(3)$ acts upon itself by left multiplication.
  This action can be lifted to an action on $T^*\SO(3)$ given by
  \begin{align*}
    (R,P) \in T^* \SO(3) \stackrel{g \in \SO(3) }{\mapsto}
    (g R , gP ) \in T^* \SO(3).
  \end{align*}
  It is notable that $\Pi = R^T P = R^T g^T g P = (gR)^T (gP)$
  is unaltered by this transformation.
  Therefore the Hamiltonian, $h(\Pi)$, is invariant under this action of $\SO(3)$.
  By Noether's theorem there is a conserved quantity associated to 
  this symmetry.
  The conserved quantity is manifested by the \emph{momentum map}
  \begin{align*}
    J_L(R,P) = PR^T .
  \end{align*}
  Moreover, due to this symmetry, one can write the evolution equations
  on a lower-dimensional space.
  The very fact that the Hamiltonian is written in terms of $\Pi$
  suggests that the equations of motion can be written in terms of $\Pi$ alone.
  Indeed this is the case,
  \begin{align}
    \dot{\Pi} = \Pi \times (\mathbb{I}^{-1} \Pi ). \label{eq:rigid_body}
  \end{align}
  This equation can be seen as a Hamiltonian equation on $\mathbb{R}^3$
  with respect to the non-canonical Poisson bracket
  \begin{align}
    \{ F , G \}_{\rm Nambu}(x)  = - x \cdot (\nabla F \times \nabla G) \label{eq:Nambu}
  \end{align}
  known as the \emph{Nambu bracket}.
  This is no coincidence. Let us first introduce the isomorphism of
  Lie algebras $(\R^3,\times)$ and $\so(3)$, given by the hat map
  \begin{equation}\label{eq:hat-map}
    x \in \R^3 \mapsto
    \hat{x} = 
    \begin{bmatrix}
      0   & -x_3 &  x_2 \\
      x_3 & 0    & -x_1 \\
     -x_2 &  x_1 & 0
    \end{bmatrix} \in \so(3).
  \end{equation}
  \begin{prop}[see \S 2.5 \cite{HolmBook2}] \label{prop:Nambu}
    The Nambu bracket on $\mathbb{R}^3$
    is identified to the Lie--Poisson bracket on $\so(3)^*$
    through the hat map isomorphism~\eqref{eq:hat-map}
    in the sense that $\{ f,g\}_{\rm Nambu}( x) = \{ \hat{f} , \hat{g} \}_{\rm LP}( \hat{x})$
    where $f,g \in C^1(\mathbb{R}^3)$ and 
    $\hat{f},\hat{g} \in C^1(\so(3)^*)$ are defined by 
    $\hat{f}( \hat{x} ) = f(x), \hat{g}( \hat{x} ) = g(x)$.
  \end{prop}
  \begin{proof}
    The Lie--Poisson bracket on $\so(3)^*$ is
    \begin{align*}
      \{ \hat{f} , \hat{g} \}_{\rm LP} (\hat{\Pi}) =
      \left \langle \hat{\Pi} , \left[ d\hat{f}(\hat{\Pi}) , d\hat{g}(\hat{\Pi}) \right]
        \right \rangle,
    \end{align*}
    for arbitrary functions $\hat{f},\hat{g} \in C^1(\so(3)^*)$.
    There exists functions $f,g \in C^1(\mathbb{R}^3)$ related to $\hat{F},\hat{G}$ through the hat map.
    One can observe that $d\hat{f}(\hat{\Pi}) \in \so(3)$ is 
    related to $\nabla f(\Pi)$ through the relation $\widehat{ \nabla f(\Pi)} = d\hat{f}( \hat{\Pi})$.
    We see that the commutator bracket satisfies
    \begin{align*}
      [\hat{x},\hat{y} ] := \hat{x} \hat{y} - \hat{y} \hat{x} = \widehat{x \times y }.
    \end{align*}
    Therefore the Lie--Poisson bracket can be written as
    \begin{align*}
    \{ \hat{f} , \hat{g} \}_{\rm LP}(\hat{\Pi})
    &= \langle \hat{\Pi} , \widehat{ \nabla f \times \nabla g }(\Pi) \rangle \\
    &= \Pi \cdot  \left( \nabla f \times \nabla g \right)(\Pi) \\
    &= \{ f , g \}_{\rm Nambu}(\Pi).
    \end{align*}
  \end{proof}

  Recall that $T^*\SO(3)$ is a symplectic manifold.
  By Theorem \ref{thm:commuting_actions}
  we can observe that $J_L$ and $J_R$ have symplectically
  orthogonal kernels and the diagram
  \begin{alignat*}{2}
    \so(3)^* \stackrel{J_L}{\longleftarrow}&
    \,T^* \SO(3)
    &&\stackrel{J_R}{\longrightarrow} \so(3)^* \\
     PR^T \stackrel{J_L}{\longmapsfrom}&
    \;\; (R,P)
    &&\stackrel{J_R}{\longmapsto} R^TP
  \end{alignat*}
  is a dual pair
  (see page \pageref{thm:dual_pairs} for details).
  The maps $J_L$ and $J_R$ are known as \emph{Clebsch variables}. 

  By Theorem \ref{thm:dual_pairs}, this dual pair expresses rigid
  body dynamics and conserved quantities.
  Specifically, the right leg yields the reduced phase space where 
  the system evolves in time.
  The left leg yields the conserved quantities of the rigid body
  associated to the left action of $\SO(3)$ on itself.
  The most important aspect of these maps is that they are both Poisson
  maps, i.e.\ they carry the canonical Poisson bracket on $T^* \SO(3)$
  to the Nambu bracket on $\so(3)^* \equiv (\mathbb{R}^3,\times)$,
  as the following Proposition shows.

  \begin{prop}[remark 2.5.11 \cite{HolmBook2}] \label{prop:SO3_to_Nambu}
    Let $\{ \cdot , \cdot \}_{\rm can}$ denote the canonical Poisson bracket
    on the cotangent bundle $T^* \SO(3)$.
    Let $\{ \cdot , \cdot \}_{\rm Nambu}$ denote the Nambu bracket on $\mathbb{R}^3$.
    Both $J_L$ and $J_R$ are Poisson maps.
    Explicitly, this means
    \begin{align*}
      -\{ f \circ J_L , g \circ J_L \}_{\rm can} = \{ f , g \}_{\rm Nambu} \circ J_L \\
      \{ f \circ J_R , g \circ J_R \}_{\rm can} = \{ f , g \}_{\rm Nambu} \circ J_R \\
    \end{align*}
    for any $f,g \in C^2( \mathbb{R}^3)$.
  \end{prop}
  \begin{proof}
    Let $(R,P) \in T^* \SO(3)$ and set $\Pi = J_R(R,P)$.
    We observe that
    \begin{align*}
      \langle \Pi , \Omega \rangle
      = \tr( \hat{\Pi}^T \hat{\Omega} ) 
      = \tr( P^T R \hat{\Omega} ) 
      = \langle P , R \cdot \hat{\Omega} \rangle.
    \end{align*}
    This tells us that $J_R$ is the momentum map associated
    to the cotangent lift of the right action of $\SO(3)$ on itself.
    Cotangent lifts of group actions are always equivariant
    and thus yield Poisson maps (Theorem 12.4.1 \cite{MandS}).
    Thus $J_R$ carries the canonical
    Poisson bracket on $T^* \SO(3)$, to the Lie--Poisson
    bracket on $\so(3)^*$.
    By proposition \ref{prop:Nambu}, this is nothing but the
    Nambu bracket upon identifying $\so(3)$ with $\mathbb{R}^3$.
    The same argument applies to $J_L$ using a left action.
  \end{proof}

  One can obtain solutions to \eqref{eq:rigid_body}
  by solving canonical Hamiltonian equations with respect to $H(R,P)$.
  In particular, if $(R,P)(t)$ is a solution to Hamilton's equation,
  then $\Pi(t) = J_R( (R,P)(t))$ is a solution to Hamilton's equation
  with respect to the Nambu-bracket.
  This is a result of Proposition \ref{prop:Poisson_dynamics}
  paired with the observation that $J_R$ is a Poisson map via
  Proposition \ref{prop:SO3_to_Nambu}.


\section{Regularized fluids}
  Euler's equations of motion for incompressible fluids can be seen as
  Hamiltonian equations on the (dual) space of divergence
  free vector fields \cite{Arnold1966}.
  Consider the Lie-algebra of vector fields on $\mathbb{R}^n$, 
  denoted by $\mathfrak{X}(\mathbb{R}^n)$.
  Formally, the dual space to $\mathfrak{X}(\mathbb{R}^n)$ is a Poisson
  manifold when equipped with the Lie-Poisson bracket
  (see \eqref{eq:Lie-Poisson} in Appendix \ref{sec:Poisson}).
  We may consider the map
  $\psi: T^*R^n \to \mathfrak{X}(\mathbb{R}^n)^*$
  given implicitly by
  \begin{align*}
    \langle \psi(q,p) , u \rangle = p \cdot u(q) \quad
    \forall u \in \mathfrak{X}(\mathbb{R}^n), (q,p) \in T^*\mathbb{R}^n.
  \end{align*}
  Explicitly we may write $\psi$ using the Dirac-delta
  functional as $\psi(q,p) = p \otimes \delta_q$.
  It is shown in \cite{HolmMarsden2005} that this map is Poisson.
  Furthermore, as the $n$-dimensional Camassa--Holm equation \cite{CamassaHolm1993} is a
  Hamiltonian equation on $\mathfrak{X}(\mathbb{R}^n)^*$,
  Proposition \ref{prop:Poisson_dynamics} promises to express a 
  certain subset
  of solutions by solving Hamiltonian equations for a finite number
  of particles.
  Specifically, $\psi$ yields the peakon solutions of the $n$-dimensional
  Camassa--Holm equation.
  In this section we explore analogous constructions for
  an incompressible and regularized version of the
  Camassa--Holm equation discovered in \cite{MumfordMichor2013}.

%  \subsection{The group of $H^\infty$-diffeomorphisms}
%  Let $H^k( \R^n ; \R^n)$ denote the space of
%  maps from $\R^n$ to $\R^n$ with bounded $H^k$-norm.
%  We define
%  \begin{align*}
%    H^{\infty}(\R^n ; \R^n) = \bigcap_{k \in \mathbb{N} } H^k( \R^n ; \R^n).
%  \end{align*}
%  Let $\mathfrak{X}_{\rm div}(\R^n)$ denote the space of
%  $H^{\infty}$ divergence free vector fields on $\mathbb{R}^n$.
%  This is the Lie algebra associated to the group of $H^\infty$
%  volume preserving diffeomorphisms, $\SDiff(\mathbb{R}^n)$.
%  That is
%  \begin{align*}
%    \SDiff(\mathbb{R}^n) &:= 
%    \left\{ \varphi \in H^{\infty}( \mathbb{R}^n ; \mathbb{R}^n) \vert 
%      \begin{array}{l}
%        \varphi^{-1} \in H^{\infty}( \mathbb{R}^n ; \mathbb{R}^n) \\
%        \det( D\varphi) = 1 
%      \end{array}
%      \right\} \\
%    \mathfrak{X}_{\rm div}(\mathbb{R}^n) &:= 
%    \left\{ u \in H^{\infty}( \mathbb{R}^n ; \mathbb{R}^n) \vert 
%      \begin{array}{l}
%        {\rm div}( u ) = 0 
%      \end{array}
%      \right\}.
%  \end{align*}
%  Enforcing that all maps be $H^\infty$ ensures sufficient decay
%  properties at infinity for differential geometric techniques to be
%  applied.  In particular, $\mathfrak{X}_{\rm div}(M)$ becomes
%  a Frechet vector-space, and
%  $\SDiff(\R^n)$ inherits a well defined exponential map for all time.
%  Exponential charts make $\SDiff(\R^n)$ into a  Frech\'et manifold
%  \cite{MichorMumford2013}.
%  \todo[inline]{Not sure if I can just add this incompressibility constraint.  Consider cutting this subsection}
%  

In the case where $h_{\rm Euler}(m) = \frac{1}{2} \| m \|^2_{L^2}$ is the standard fluid kinetic energy on the
dual vector space to the incompressible vector fields, $\mathfrak{X}_{\rm div}(\mathbb{R}^n)^*$, 
Hamilton's equations are written as
\begin{align}
	\partial_t m+ \lie_u [ m] = 0 \quad , \quad u^i = \delta^{ij} m_j. \label{eq:ideal_fluid}
\end{align}
where $\lie_u[m]$ is the Lie derivative of $m$.
The primary finding of \cite{Arnold1966} was that \eqref{eq:ideal_fluid} is equivalent to the
inviscid fluid equation
\begin{align*}
	\partial_t u + u \cdot \nabla u = - \nabla p \quad , \quad  \nabla \cdot u = 0.
\end{align*}
Since we have not yet clarified the Poisson structures of the system, it may not be obvious that \eqref{eq:ideal_fluid} is a Hamiltonian equation. The following proposition shows this for a general Hamiltonian  on $\mathfrak{X}_{\rm div}(\R^n)^*$.
% That \eqref{eq:ideal_fluid} is a Hamiltonian equation, may not be obvious because
% we have not clarified the Poisson structures of the system.
% In the following proposition we will show this for a general Hamiltonian on $\mathfrak{X}_{\rm div}(\R^n)^*$.

  \begin{prop}[\cite{Arnold1966}] \label{prop:LPDiff}
  Let $h \in C^{\infty}( \mathfrak{X}_{\rm div}(\R^n)^* )$.
  Recall that $\mathfrak{X}_{\rm div}(\R^n)^*$ is a Poisson manifold
  when equipped with the Lie--Poisson bracket,
  and given a function $h$, the Fr\'echet derivative $dh(m)$ is an element  of $\mathfrak{X}_{\rm div}(\R^n)^{**}$.
  In the event that $dh(m) \in \mathfrak{X}_{\rm div}(\R^n)$,
  Hamilton's equations are given by
  \begin{align}
    \dot{m} + \lie_u [m] = 0 \quad , \quad u = dh(m) \label{eq:LP}.
  \end{align}
\end{prop}
\begin{proof}
  To each $v \in \mathfrak{X}_{\rm div}(\R^n)$
  we can associate a linear function on $\mathfrak{X}_{\rm div}(\R^n)^*$
  given by $m \in \mathfrak{X}_{\rm div}(\R^n)^* \mapsto \langle m , v \rangle \in \R$.
  Let us denote this function by $f_v$.
  Let $m(t)$ satisfy Hamilton's equations.
  By the definition of the Lie--Poisson bracket
  (see \eqref{eq:Lie-Poisson} in Appendix \ref{sec:Poisson})
  we observe
  \begin{align*}
    \frac{d}{dt} f_v(m) &= \{ f_v , h \}(m) = \langle m , [ df_v(m) , dh(m) ] \rangle \\
    &= \langle m , \lie_{dh(m)}[ df_v(m) ] \rangle
  \end{align*}
  However $df_v = v$ and so
  the last line can be equated with  $-\langle \lie_{dh(m)}[m] , v \rangle$.
  Additionally, we know that $\frac{d}{dt} f_v(m) = \langle \dot{m} , v \rangle$ since $v$ is constant in time.
  Therefore we find
  \begin{align*}
    \langle \dot{m} + \lie_{dh(m)} [m] , v \rangle = 0.  
  \end{align*}
  As $v$ is arbitrary, this uniquely characterizes $\dot{m}$.\footnote{This is \emph{not} a ``weak'' characterization.  The entity $\dot{m}$ is
  contained in the dual space to $\mathfrak{X}_{\rm div}(\R^n)$ and it is
  therefore \emph{defined uniquely} by how it acts on $\mathfrak{X}_{\rm div}(\R^n)$.}
  The result follows.
\end{proof}

\subsection{The Mumford--Michor model}
\label{sec:MME}
Consider the Hamiltonian
\begin{align*}
  h_{p,\sigma}(m) = \frac{1}{2} \langle m , K_{p,\sigma} * m \rangle_{L^2}
\end{align*}
where $K_{p,\sigma}:\R^n \to \mathbb{R}^{n \times n}$ is the matrix
valued Green's kernel defined by the property
\begin{align*}
 \Big(1 - \frac{\sigma^2}{p} \Delta \Big)^p \cdot \int_{\R^n} K_{p,\sigma}^{ij}(x - y) m_j(y) dy = \delta^{ij} m_j(x).
\end{align*}
In this case Hamilton's equations take the form
\begin{align}
	\partial_t m+ \lie_u [ m] = 0 \quad , \quad u^i  = K^{ij}_{p,\sigma} * m_j. \label{eq:MMDiff}
\end{align}
Solutions to \eqref{eq:MMDiff} exhibit existence and uniqueness for all time.
Moreover, as $\sigma \to 0$, $h_{p,\sigma} \to h_{\rm Euler}$ and one
can speculate that solutions to~\eqref{eq:MMDiff}
approach solutions to the ideal fluid equation~\eqref{eq:ideal_fluid}.
In fact, this is the case over short times, and for $\sigma > 0$ solutions of \eqref{eq:MMDiff}
differ from those of \eqref{eq:ideal_fluid} by an amount $\sigma t$
in the $H^k$-norm.
Thus Hamilton's equations with respect to $h_{p,\sigma}$ have been proposed
as a model for ideal fluids \cite[Theorems 2 and 3]{MumfordMichor2013}. From now on we shall often suppress the
parameters $p,\sigma$ and shorten $K = K_{p,\sigma}$ to prevent index
clutter.

Next, we discuss a dual pair for this system.
The group $\SDiff(\R^n)$ acts on itself from the left and from the right.
These actions can be lifted to $T^* \SDiff(\R^n)$, and yield
momentum maps $J_L,J_R : T^*\SDiff(\R^n) \to \mathfrak{X}_{\rm div}(\R^n)^*$. In particular these maps form the dual pair
\begin{align*}
  \mathfrak{X}_{\rm div}(\R^n)^*
  \stackrel{J_L}{\longmapsfrom}
  T^* \SDiff(\R^n)
  \stackrel{J_R}{\longmapsto}
  \mathfrak{X}_{\rm div}(\R^n)^*.
\end{align*}
For a mathematically rigorous treatment of this dual pair we refer to \cite{GayBalmazVizman2012}.

By theorem \ref{thm:dual_pairs}, we can use this dual pair to derive dynamical properties of Hamiltonian equations defined on $\mathfrak{X}_{\rm div}(\R^n)^*$.
The Hamiltonian for a fluid is written on the left instance of $\mathfrak{X}_{\rm div}(\R^n)^*$.
One can (in principle) solve Hamilton's equations on $T^*\SDiff(\R^n)$
with respect to the Hamiltonian $H = h \circ J_L$.
This yields the \emph{material} or \emph{Lagrangian} coordinate perspective
of fluid mechanics one encounters in a first course on continuum
mechanics.
The right leg yields conserved quantities associated to the particle relabeling symmetry of the fluid.
It was found in \cite{Arnold1966} that these conserved momenta are identical
to the law of conservation of circulation, a.k.a. \emph{Kelvin's circulation theorem}.

Unfortunately, this dual pair does not help us in solving \eqref{eq:MMDiff}
since solving Hamilton's equations on $T^*\SDiff(\R^n)$ is no less difficult
than solving Hamilton's equations on $\mathfrak{X}_{\rm div}(\R^n)^*$.
In the next section we will derive a dual pair wherein the symplectic
manifold is more reasonable.
This will yield the particle-like solutions described in \cite{MumfordMichor2013}. In the later parts of the paper we will generalize the treatment to obtain a  dual pair for each level in the hierarchy of particle-like solutions.

\subsection{Particle-like solutions}
\label{sec:Momentum maps}
There is a natural left group and algebra action of $\SDiff(\R^n)$
and $\mathfrak{X}_{\rm div}(\R^n)$, respectively, on $\R^n$ given by
\begin{align*}
  q \in \R^n
  &\stackrel{ \varphi \in \SDiff(\R^n) }{\longmapsto}
  \varphi(q) \in \R^n \\
  q \in \R^n
  &\stackrel{ u \in \mathfrak{X}_{\rm div}(\R^n) }{\longmapsto}
  u(q) \in T_q\R^n.
\end{align*}
The tangent lift of the former is defined in the obvious way by sending
\begin{align*}
  (q,v) \in T\R^n \equiv \R^n \times \R^n
  \stackrel{ \varphi \in \SDiff(\R^n) }{\longmapsto}
  \big(\varphi(q) , (\partial_j\varphi^i(q) v^j) \partial_i \big) \in T_{\varphi(q)} \R^n.
\end{align*}
The cotangent lift is defined by taking the dual
of  the tangent lifted action.
That is to say,
\begin{align*}
  (q, p) \in T^*\R^n \equiv \R^n \times \R^n
  \stackrel{ \varphi \in \SDiff(\R^n) }{\longmapsto}
  \big(\varphi^{-1}(q) , (\partial_i\varphi^j(q) p_j) e^i \big)
\end{align*}
where $\{e^i\}$ forms the dual basis to $\{\partial_i\}$ at $\varphi^{-1}(q)$.
The momentum map
$J^{(0)}_L : T^*\R^n \to \mathfrak{X}_{\rm div}(\R^n)^*$
associated to this left action is defined by the
condition
\begin{align*}
  \langle J_L^{(0)}( q , p) , u \rangle := \langle p , u(q) \rangle,
\end{align*}
for all $u \in \mathfrak{X}_{\rm div}(\R^n)$ and $(q,p) \in T^*\R^n$ (see \eqref{eq:cotangent_momap} in Appendix \ref{sec:Symplectic}); the superscript in $J_L^{(0)}$ serves as a reminder that we are considering the zeroth level in the hierarchy of particle-like solutions.
%We shall now write $J_L^{(0)} = J_L$ in anticipation of the
%introduction of higher-order particles in section~\ref{sec:higher_order}.
%On $\R^n$ we may identify the dual space of $\mathfrak{X}_{\rm div}(\R^n)$
%with the space of closed $H^\infty$ one-forms by using the Euclidean volume form.
%That is to say, any covector field \todo{JE: distribution?} $m = m_i dx^i \in \mathfrak{X}_{\rm div}(\R^n)^*$
%can be paired with a vector field $v = v^i \frac{\partial}{\partial x^i} \in \mathfrak{X}_{\rm div}(\R^n)$
%to produce the real-valued function
%$ m_i(x) v^i(x)$
%which can then be integrated with respect the Euclidean volume form to produce a real number.
We see that $J_L^{(0)}(q,p)$ is an evaluation operator, and we can write it 
more explicitly as a measure-valued momentum map in terms of the Dirac-delta distribution as
\begin{align*}
  J_L^{(0)}( q , p ) = p \otimes \delta_q
\end{align*}
where $\delta_q$ is the Dirac-delta distribution on $\R^n$ centered at $q$.
This identification holds modulo $dC^1(\R^n) \otimes d{\bf x}$ where $dC^1(\R^n)$
is the space of $C^0$-exact one-forms and $d{\bf x}$ is the canonical volume from on $\R^n$
(see Appendix \ref{sec:measure_valued_momap}).
Since $J_L^{(0)}$ is a cotangent-lift momentum map, it is equivariant and therefore Poisson, again by \cite[Thm~12.4.9]{MandS}.
% As the cotangent lifted action of $\SDiff(\R^n)$ is equivariant,
% we observe that $J_L^{(0)}$ is Poisson, again by 

We define the manifold for particles,
\begin{align*}
  Q_N^{(0)} = \left\{ (q_1,\dots,q_N) \in \R^n \times \dots\times \R^n
                 \mid q_a \neq q_b \text{ when } a \neq b \right\}.
\end{align*}
We will index the particles with $a,b,c,\dots$ and Cartesian coordinate
directions in $\R^n$ with indices $i,j,k,\dots$
Thus each $q \in Q_N^{(0)}$ can be decomposed
into $N$ particles as $(q_1,\dots,q_N)$, where each $q_a \in \R^n$
and the $i^{\rm th}$ coordinate of the $a^{\rm th}$ particle
is denoted by $q\indices{_a^i}$.

The group $\SDiff(\R^n)$ acts on $Q_N^{(0)}$ by the diagonal action.
Through the same manipulations as we applied previously we obtain the
momentum map for $N$ particles given by
\begin{align*}
  J_L^{(0)}(q,p) = p_a \otimes \delta_{q_a},
\end{align*}
where a sum over repeated indices is implied.

By Propositions~\ref{prop:Poisson_dynamics} and~\ref{prop:LPDiff},
we obtain solutions to Hamilton's equations
on $\mathfrak{X}_{\rm div}(\R^n)^*$, by solving
Hamilton's equations on $T^*\R^n$ if $dh( J_L^{(0)}(q,p) )$ is
a vector field.  If $h = h_{p,\sigma}$, then we calculate that $dh$
evaluated on the $J_L^{(0)}(p,q)$ is the vector field
\begin{align*}
	dh( p_a \otimes \delta_{q_a} )  (x) = K^{ij}(x - q_a) p_{a\,j} \pder{}{x^i}.
\end{align*}
This is a vector field whose differentiability is determined completely by that of
the kernel, $K$.
\begin{figure}
	\centering
	\includegraphics[width = 0.4\textwidth]{./images/zero_jet.pdf}
	\includegraphics[width = 0.4\textwidth]{./images/zero_jet_3D.png}
	\caption{A $0$-jetlet with momentum $m = (1,0)^T \otimes \delta_0$ in dimensions $2$ and $3$.
	(LEFT) a quiver plot of the induced 2 dimensional velocity field.
	(RIGHT) a streamline plot of the induced 3 dimensional velocity field. }
	\label{fig:zero_jetlet}
\end{figure}
Once one has found a solution $(q(t), p(t))$ to Hamilton's equations on $T^*\mathbb{R}^n$ and thus also a solution to Hamilton's equations on $\mathfrak{X}_{\rm div}(\mathbb{R}^n)^*$, one can proceed to integrate the corresponding time-dependent vector field to obtain the fluid motion $\varphi_t$ in $\rm{SDiff}(\mathbb{R}^n)$. It is natural (but not mandatory) to choose the initial map $\varphi_0$ to be the identity or at least to be a diffeomorphism that satisfies $\varphi_0(q_a(0))= q_a(0)$ for all $a$.
  If this choice is made, one can interpret the curve $q(t) = (q_1(t), \ldots, q_N(t))$ in $Q_N^{(0)}$ as the locations of particles as they are swept along by the fluid flow, that is, $q_a(t) = \varphi_t(q_a(0))$ for all $a = 1, \ldots, N$. 
  
  We see that $J_L^{(0)}$ is injective, and thus has a trivial kernel. As a result, the symplectic orthogonal to the kernel of $J_L^{(0)}$  is the full tangent bundle $T(T^*Q_N^{(0)})$. Hence, if we define the (trivial) map $J_R^{(0)}: T^*Q^{(0)}_N \to \mathfrak{X}_{\rm div}(\mathbb{R}^n)^*$ by $J_R^{(0)} \equiv 0$, it follows that the diagram
 \begin{alignat*}{2}
    \mathfrak{X}_{\rm div}(\R^n)^* \stackrel{J_L^{(0)} }{\longleftarrow}&
    \,T^* Q_N^{(0)}
    &&\stackrel{J_R^{(0)} }{\longrightarrow} \mathfrak{X}_{\rm div}(\R^n)^* \\
    p_a \otimes \delta_{q_a} \stackrel{J_L^{(0)}}{\longmapsfrom}&
    \;\;(q,p)
    &&\stackrel{J_R^{(0)} }{\longmapsto} 0
  \end{alignat*}
  is a dual pair. 
  This dual pair allows us to express conservation
  laws and dynamics as a result of theorem \ref{thm:dual_pairs}.
   Namely, the left leg represents the space in which particle-like
  solutions to \eqref{eq:MMDiff} evolve,
  while the right leg represents a (trivial) conserved quantity. 
    
  In order to make contact with the later parts of the paper, it is useful to remark that $J_R^{(0)}$ can formally be understood as the cotangent lift momentum map associated with a certain (trivial) group action.
  To that end, we fix a designated point $z = (z_1, \ldots, z_N) \in Q_N^{(0)}$ and take an arbitrary element $ q= (q_1, \ldots, q_N) \in Q_N^{(0)}$ to represent the set of all $\varphi \in {\rm SDiff}(\mathbb{R}^n)$ that satisfy $\varphi \cdot z  = q$.
  That is, $\varphi(z_a) = q_a$ for all $a$.
  This means in particular that the specification of $(q_1, \ldots, q_N)$ fixes the $0^{\rm th}$ order Taylor expansion (at the locations $z_a$) of the corresponding set of diffeomorphisms. With this in mind, let us define the isotropy group
\begin{align}
{\rm iso}(z)  = \{ \psi \in {\rm SDiff}(\mathbb{R}^n) | \psi(z_a) = z_a \mbox{ for all } a\} \label{isotropy_group}
\end{align}
and a (trivial) right action on $Q_N^{(0)}$ where $\psi \in {\rm iso}(z)$ maps an element $(\varphi(z_1), \ldots, \varphi(z_N))$ to $( \varphi \circ \psi (z_1), \ldots, \varphi \circ \psi(z_N))$.
Similar constructions will be crucial in later sections, when constructing the right leg of a dual pair for the higher levels in the hierarchy of particle-like solutions.

  In summary we find:
  \begin{prop}[\S7 of \cite{MumfordMichor2013}] \label{prop:0-solutions}
  Let $p \geq \frac{n}{2} +1$ and $\sigma > 0$.
  Let $H:T^*Q_N^{(0)} \to \R$ be the function
  \begin{align*}
    H(q,p) =\frac{1}{2} K_{p,\sigma}^{ij}(q_a - q_b)\, p_{a\,i}\, p_{b\,j}.
  \end{align*}
  If $(q,p)(t)$ is a solution to Hamilton's equations, then
  $m(t) = p_a(t) \otimes \delta_{q_a(t)}$
  is a solution to \eqref{eq:MMDiff}.
\end{prop}
\begin{proof}
	Note that $H = h_{p,\sigma} \circ J_L^{(0)}$ and apply theorems \ref{thm:dual_pairs} and  \ref{thm:commuting_actions}.
\end{proof}

\subsection{$1^{\rm st}$-order particle-like solutions}
\label{sec:first_order}
In this section we revisit the $1^{\rm st}$-order particle-like solutions of \cite{CotterHolmJacobsMeier2014} and discuss its dual pair, before extending the treatment to the higher levels of the hierarchy in the subsequent section. 
  Let $\SL(n)$ denote the Lie group of $n\times n$ matrices
  with unit determinant.
  Let $q = (q^{(0)}, q^{(1)}) \in \R^n \times \SL(n)$ and consider the left
  $\SDiff(\R^n)$ action on $\R^n \times \SL(n)$ given by
  \begin{align}
    \varphi \cdot q = (\varphi(q^{(0)} ) , D\varphi(q^{(0)} ) \cdot q^{(1)} ). \label{eq:first_order_action}
  \end{align}
  Where $D\varphi(q^{(0)} ) \cdot q^{(1)}$ is the result of multiplying
  the Jacobian matrix $D\varphi(q^{(0)} )$ with $q^{(1)}$.
  \begin{prop}
    The action of $\SDiff(M)$ on $\R \times \SL(n)$ in \eqref{eq:first_order_action} is a group action.
  \end{prop}
  \begin{proof}
    As $\varphi \in \SDiff(\R^n)$, it follows that $D\varphi |_{q^{(0)}} \in \SL(n)$.
    Therefore $D\varphi |_{q^{(0)}} \cdot q^{(1)} \in \SL(n)$.
    Secondly, if $\varphi_1,\varphi_2 \in \SDiff(\R^n)$ we observe that
    \begin{align*}
      \varphi_2 \cdot (\varphi_1 \cdot q)
      &= \varphi_2 \cdot \big(\varphi_1(q^{(0)} ) , D\varphi_1 |_{q^{(0)}} \cdot q^{(1)} \big) \\
      &= \big(\varphi_2(\varphi_1(q^{(0)} )) , \left. D\varphi_2 \right|_{\varphi_1( q^{(0)} )} \cdot D\varphi_1 |_{ q^{(0)} } \cdot q^{(1)} \big) \\
      &= \big( (\varphi_2 \circ \varphi_1)(q^{(0)} ) , D( \varphi_2 \circ \varphi_1)|_{q^{(0)} } \cdot q^{(1)} \big) \\
      &= (\varphi_2 \circ \varphi_1) \cdot q,
    \end{align*}
    where the second and third lines are applications of the chain rule.
  \end{proof}
  As before, this action can be lifted to the cotangent bundle $T^*(\R^n \times \SL(n))$.  Specifically, 
  the action of the diffeomorphism $\varphi^{-1}$ is given by
  \begin{align*}
    & (T\varphi)^* \cdot ( q^{(0)} , q^{(1)}  , p^{(0)} , p^{(1)} ) \\
    &\quad = \big( \varphi^{-1}(q^{(0)})  , [D\varphi|_{q^{(0)}}]^{-1} \cdot q^{(1)} , D\varphi|_{q^{(0)}}^* \cdot p^{(0)} , D\varphi|_{q^{(0)}}^* \cdot p^{(1)} \big).
  \end{align*}
  Also as before, we can generalize this construction to the space of
  $N > 1$ particles by considering the space
  \begin{align*}
    Q^{(1)}_N = \left\{  ( q_1 , \dots, q_N ) \mid
      \begin{array}{c}
        q_a = (q^{(0)}_a,q^{(1)}_a) \in \R^n \times \SL(n) \\
        q^{(0)}_a \neq q^{(0)}_b \text{ when } a \neq b
      \end{array} \right\}.
  \end{align*}
  For convenience it is nice to choose coordinates at this point.
  If we let $q_a$ denote the position of the $a^{\rm th}$ particle,
  $q\indices{_a^i}$ denote the $i^{\rm th}$ component of this position,
  and let $q\indices{_a^i_j}$ denote the $(i,j)$ entry of the $a^{\rm th}$
  matrix then the resulting momentum map is defined by the condition
  \begin{align*}
    \langle J_L^{(1)}(q,p) , u \rangle
    = p\indices{_a_i} u^i(q^{(0)}_a) + p\indices{_a_i^j} \partial_k u^i(q^{(0)}_a) q\indices{_a^k_j}
  \end{align*}
  for an arbitrary $u \in \mathfrak{X}_{\rm div}(\R^n)$.
  In terms of the Dirac-delta functional, we can write $J_L^{(1)}$ as the measure-valued momentum map
  \begin{align*}
    J_L^{(1)}(q, p)
    = p\indices{_a_i} dx^i \otimes \delta_{q_a}
     -p\indices{_a_i^j} q\indices{_a^k_j} dx^i \otimes \partial_k \delta_{q_a}
  \end{align*}
  Next, we construct a dual momentum map associated with a right action on $Q_N^{(1)}$. Analogous to the previous section  it is useful at this stage to write elements of $Q_N^{(1)}$ in the form $ \varphi \cdot z = (\varphi (z_1, {\mathbf{1}}), \ldots, \varphi \cdot (z_N , \mathbf{1}))$, $\varphi \in {\rm SDiff}(\mathbb{R}^n)$, for some designated element $ z=( (z_1, \mathbf{1}), \ldots, (z_N, \mathbf{1}))$. Clearly, every element of $Q_N^{(1)}$ can be written in this form for some  $\varphi \in {\rm SDiff}(\mathbb{R}^n)$. Indeed, with this convention the specification of an element in $Q_N^{(1)}$ fixes the $1^{\rm st}$ order Taylor expansion of $\varphi$ at the locations $z_a$, $a = 1, \ldots, N$. With this in mind, let us recall the isotropy group ${\rm iso}(z)$ defined earlier in \eqref{isotropy_group}, which leaves these locations invariant, and define a right action on  $Q_N^{(1)}$ given by 
\begin{align}
	 (\varphi \cdot z) \cdot \psi  = (\varphi \circ \psi) \cdot z. \notag
	 \end{align}
	 That is, 
 \begin{align}
	 (q^{(0)}, q^{(1)}) \cdot \psi = \left( \left(q_1^{(0)}, q_1^{(1)} \cdot D\psi|_{z_1}\right), \ldots, \left(q_N^{(0)}, q_N^{(1)} \cdot D\psi|_{z_N}\right)\right). \label{1-rightaction}
\end{align}
In Proposition \ref{HL_action_prop} we will generalize this construction to define a right action for the higher levels in the hierarchy of particle-like solutions.
  The action \eqref{1-rightaction} yields the cotangent-lift momentum map defined by the condition
  \begin{align*}
    \langle J_R^{(1)}(q,p) , u \rangle = p\indices{_a_i^j} q\indices{_a^i_k} \partial_j u^k(z_a)
  \end{align*}
  In terms of the Dirac delta functional we may write this as the measure-valued momentum map
  \begin{align*}
    J_R^{(1)}(q,p) = - p\indices{_a_i^j} q\indices{_a^i_k} dx^k \otimes \partial_j \delta_{z_a}
  \end{align*}
%  \je{Shouldn't $\delta_{q_a}$ be $\delta_{z_a}$ here? Or change the formula above? -- DM: I agree. I have changed it and removed the box.}
  \begin{prop}
    The momentum maps $J_L^{(1)}$ and $J_R^{(1)}$ form a dual pair.
  \end{prop}
  \begin{proof}
    The actions of $\iso(z)$ and $\SDiff(\R^n)$ on $Q_N^{(1)}$
    clearly commute
    and lift to symplectic actions on $T^*Q_N^{(1)}$.
    Moreover, the action of $\SDiff(\R^n)$ is transitive on the level sets of $J_R^{(1)}$, since it is transitive overall.
    By theorem \ref{thm:commuting_actions}, $J_L^{(1)}$ and $J_R^{(1)}$ form a dual pair.
  \end{proof}

  As before, the quantity $dh( J_L^{(1)}(q,p))$ is a legitimate vector field
  if $K_{p,\sigma}$ is sufficiently smooth.  Moreover, when the Hamiltonian
  $H^{(1)} = h_{p,\sigma} \circ J_L^{(1)}$ is $C^1$ we may evolve Hamilton's equations
  to obtain solutions.

  \begin{prop} \label{prop:1-solutions}
    Let $p \ge \frac{n}{2} + 2$ and $\sigma > 0$.
    Then $H^{(1)} = h_{p,\sigma} \circ J_L^{(1)}$ is $C^1$ and given by the expression
	\begin{align*}
		H^{(1)}(q,p) &= \frac{1}{2} p\indices{_a_i} K^{ij}(q_a - q_b) p\indices{_b_j}\\
			&\quad + p\indices{_a_i^l} q\indices{_a^k_l} (\partial_k K^{ij})(q_a - q_b) p\indices{_b_j} \\
			&\quad -  \frac{1}{2} p\indices{_a_i^n} q\indices{_a^l_n} (\partial_l \partial_k K^{ij})(q_a - q_b) q\indices{_b^k_m} p\indices{_b_j^m}.
  \end{align*}
  If $(q,p)(t) \in T^*Q_N^{(1)}$ is a solution to Hamilton's equations with respect to
	$H^{(1)}$, then $J_L^{(1)}( (q,p)(t)) \in \mathfrak{X}_{\rm div}(\R^n)^*$ is
	a solution of \eqref{eq:MMDiff} and $J_R^{(1)}( (q,p)(t)) \in \mathfrak{X}_{\rm div}(\R^n)^*$ is
	constant in time. 
  \end{prop}
  The proof of the above proposition is identical to that of
  proposition~\ref{prop:0-solutions}. Note that $K_{p,\sigma}$ has
  smoothness $C^{2p-n-1}$ by considering that the Fourier
  representations of its derivatives are integrable, while we need
  $K_{p,\sigma} \in C^{2k+1}$ to allow composition with $k$th
  derivatives of delta distributions on each side and still obtain a
  $C^1$ Hamiltonian. (See also the more general condition on $p$ in
  proposition~\ref{prop:k-solutions} below.)
  As before, it is useful to interpret the trajectory $q(t)$ of the previous proposition in terms of the curve $\varphi_t \in  {\rm SDiff}(\mathbb{R}^n)$ obtained by integrating the time-dependent vector field $dh_{p, \sigma} J_L^{(1)}((q, p)(t)) = K_{p, \sigma} * J_L^{(1)}((q, p)(t))$. If one chooses $\varphi_0$ to be the identity or  any other element of ${\rm SDiff}(\mathbb{R}^n)$ that satisfies $\varphi_0 \cdot (q(0)) = q(0)$, then  $q(t) = \varphi_t \cdot  q(0)$. This implies in particular that the $q_a^{(0)}(t)$ are the trajectories of the particles as they are swept along by the fluid flow.

  Various vector fields for large kernel smoothness $p$
  are depicted in figure \ref{fig:zoo}
  for different initial values of the traceless matrix
  $\mu\indices{_i^j} = p\indices{_i^l} q\indices{^j_l}$.

  \begin{figure}
  	\centering
        \includegraphics[width=0.3\textwidth]{./images/shear.pdf}
        \includegraphics[width=0.3\textwidth]{./images/spin.pdf}
        \includegraphics[width=0.3\textwidth]{./images/stretch.pdf}
        \\
        \includegraphics[width=0.4\textwidth]{./images/stretch_3D.png}
        \includegraphics[width=0.4\textwidth]{./images/shear_3D.png}
        \caption{(TOP ROW) quiver plots of 2D vector fields induced by $1^{\rm st}$ order jetlets. 
        (BOTTOM ROW) stream-line plots of 3D vector fields induced by $1^{\rm st}$ order joltiest.}
        \label{fig:zoo}
  \end{figure}

  \subsection{Higher-order particles}
  \label{sec:higher_order}
  In this section we will introduce a hierarchy of particle solutions whose $k^{\rm th}$ level includes the solutions at the $(k-1)^{\rm th}$ level.
  The $0^{\rm th}$-level in the hierarchy are the standard particle-like solutions,
  while the $1^{\rm st}$ level describes the particles with internal $\SL(n)$ variables
  discussed in the previous section.
  The particles in the $k^{\rm th}$-level carry the coefficients of
  $k^{\rm th}$-order Taylor expansions of diffeomorphisms,
  or \emph{jets}.
  Therefore, we call these particles \emph{$k$-jetlets}.

  Let $\varphi \in \SDiff(\R^n)$.
  The zeroth-order Taylor expansion of $\varphi$ about $0$
  is $\varphi(0)$, and the collection of such Taylor
  expansions is all of $\R^n$.
  The $1^{\rm st}$-order Taylor expansion of $\varphi$ about $0$ is
  \begin{align*}
    \varphi^i( x) = \varphi^i(0) + \partial_j \varphi^i(0) x^j + o( \|x\|).
  \end{align*}
  The tuple of coefficients $(\varphi(0) , D\varphi(0) ) \in \R^n \times \SL(n)$ is
  called the $1^{\rm st}$-order jet of $\varphi$ evaluated at $0$.
  Going further, the second-order Taylor expansion of $\varphi$ about $0$
  is
  \begin{align*}
    \varphi^i(x) = \varphi^i(0) + \partial_j \varphi^i(0) x^j + 
    \frac{1}{2} \partial_{jk} \varphi^i(0) x^j x^k + o( \| x\|^2).
  \end{align*}
  We see that $D^2\varphi(0)$ is a tensor of rank $(1,2)$, which is
  symmetric in the lower indices.
  We call the space of such tensors $S^1_2$,
  and we see that the space of second-order jets is $\R^n \times \SL(n) \times S^1_2$.
  Finally, for $k \geq 2$ the space of $k^{\rm th}$ order jets is
  \begin{align*}
    Q_1^{(k)} = \R^n \times \SL(n) \times S^1_2 \times S^1_3 \times \cdots\times S^1_k
  \end{align*}
  where $S^1_j$ is the vector space of $(1,j)$-tensors which
  have been symmetrized in the covariant indices.
  The space $Q_1^{(k)}$ is equipped with the fiber bundle
  projection $\pi^{(k)} : Q_1^{(k)} \to \R^n$,
  which projects onto the $\R^n$ component.
  We define the space for an $N$-tuple of $k$-jetlets by taking a product
  \begin{align*}
    Q^{(k)}_N = \{ (q_1,\dots, q_N) \in Q_1^{(k)} \times \dots \times Q_1^{(k)}
    \mid \pi^{(k)}(q_a) \neq \pi^{(k)}(q_b) \text{ when } a \neq b \}.
  \end{align*}
  We coordinatize $Q^{(k)}_N$ as follows.
  We will use Greek indices to represent spatial
  multi-indices on $\R^n$ (see Appendix \ref{app:multi} for our multi-index convention).
  A typical coordinate on $Q^{(k)}_N$ will therefore look
  like $q\indices{_a^i_\beta}$ where $a \in \{1,\dots,N\}$, $i \in \{ 1 , \dots, n \}$
  and $\beta$ is a multi-index on $\R^n$.
  This coordinate is used to model the partial derivative of the $i^{\rm th}$ coordinate
  of a diffeomorphism at some point $z_a \in \R^n$, i.e.\ $\partial_\beta \varphi^i(z_a)$.
  % This is the primary motivation for this notational convention.
  For the statement of the next proposition, recall that the definition  of ${\rm iso}(z)$ was given earlier in \eqref{isotropy_group}. Note also that we write $\Jet^k_x: \SDiff(\R^n) \to Q_1^{(k)}$ for
    the function which evaluates the spatial derivatives
    of a diffeomorphism up to order $k$ at the location $x \in \R^n$. In the subsequent sections we will also use the obvious generalisation to multiple locations $z_1, \ldots, z_N \in \R^n$, which we will denote by $\Jet^k_z : \SDiff(\R^n) \to Q_N^{(k)}$.  

  \begin{prop}
    The group $\SDiff(\R^n)$ acts on $Q_N^{(k)}$ by a left Lie group
    action.  If $z_1,\dots,z_N \in \R^n$ are distinct points,
    then the isotropy group $\iso(z) \subset \SDiff(\R^n)$
    acts on $Q_N^{(k)}$ by a right Lie group action. \label{HL_action_prop}
  \end{prop}
  \begin{proof}
    Let $\varphi_1,\varphi_2 \in \SDiff(\R^n)$.
    The partial derivatives of $(\varphi_1 \circ \varphi_2)$
    are given by the Fa\`a di Bruno formula
    \begin{align*}
      \partial_\alpha( \varphi_1 \circ \varphi_2) = \sum_{k=1}^{|\alpha|}
      \left(
        \sum_{
        \substack{
          j_1,\dots,j_k \in \{1,\dots,n\} \\
          [\gamma_1,\dots,\gamma_k] \in \Pi(\alpha , k)
          }
          }
          \partial_{j_1 \cdots j_k} \varphi_1(\varphi_2(x))
          \partial_{\gamma_1} \varphi_2^{j_1} \cdots
          \partial_{\gamma_k} \varphi_2^{j_k}
        \right),
    \end{align*}
where we wrote $\Pi(\alpha, k)$ for the set of $k^{\rm th}$-order partitions of a multi-index $\alpha$. We refer to Appendix~\ref{app:multi} for the details of our index conventions and to \cite{ConstantineSavits1996,Jacobs2014b} for a
    precise description of the multivariate Fa\`a di Bruno formula.
    One can read off   from the expression that
    a $k^{\rm th}$ order derivative only depends on $k^{\rm th}$
    and lower order
    partial derivatives of $\varphi_1$ and $\varphi_2$.
        A left $\SDiff(\R^n)$ action is induced on $Q_1^{(k)}$ by
    setting $\varphi \cdot q = \Jet^k_z( \varphi \circ \psi)$
    for any $\psi$ such that $\Jet^k_z(\psi) = q$.
    That this is independent of the choice of $\psi$ follows
    from observing that the Fa\`a di Bruno formula
    only uses data in $q = \Jet^k_z(\psi)$ and nothing more.
    In local coordinates, this action takes the form
    \begin{align*}
    (\varphi \cdot q)^i_\alpha =
     \sum_{k=1}^{|\alpha|}
      \left(
        \sum_{
        \substack{
          j_1,\dots,j_k \in \{1,\dots,n\} \\
          [\gamma_1,\dots,\gamma_k] \in \Pi(\alpha , k)
          }
          }
          \partial_{j_1 \cdots j_k} \varphi^i(q^{(0)})
          q\indices{^{j_1}_{\gamma_1}} \cdots
          q\indices{^{j_k}_{\gamma_k}}
        \right),
    \end{align*}
    except for the component where $|\alpha | = 0$ in which case we observe $(\varphi \cdot q)^i = \varphi^i(q^{(0)})$.
    By the same construction, a right $\iso(z)$ action is induced
    on $Q_1^{(k)}$ by setting $q \cdot \varphi = \Jet^k_z(\psi \circ \varphi)$ for any $\psi$ such that $\Jet^k_z(\psi) = q$.
    We can choose distinct points $z_1,\dots,z_N \in \R^n$
    and apply the same process to $Q_N^{(k)}$.  In this case we observe the action to be
    \begin{align*}
      (q \cdot \varphi)\indices{^{ai}_\alpha} = \sum_{k=1}^{|\alpha|}
      \left(
        \sum_{
        \substack{
          j_1,\dots,j_k \in \{1,\dots,n\} \\
          [\gamma_1,\dots,\gamma_k] \in \Pi(\alpha , k)
          }
          }
          q\indices{^{ai}_{[j_1,\dots,j_k]}}
          \partial_{\gamma_1} \varphi^{j_1}(z_a) \cdots
          \partial_{\gamma_k} \varphi^{j_k}(z_a)
        \right).
    \end{align*}
  \end{proof}
  
  Just as in the previous sections, the actions of $\SDiff(\R^n)$ and $\iso(z)$ lift to commuting actions on $T^*Q_N^{(k)}$.
  The associated momentum maps are given implicitly by how they act on the respective Lie algebras.
  In particular, the left action of $\SDiff(\R^n)$ yields the momentum map
  \begin{equation*}
  	\langle J_L^{(k)}(q,p) , u \rangle =
	\sum_{a=1}^N \left( p_{am} u^m(q^{(0)}_a) +
    \sum_{\substack{ |\alpha| \leq k \\ 1 \leq \ell \leq |\alpha| }} \;
		\sum_{
			\substack{
				j_1,\dots,j_\ell \in \{1,\dots,n\} \\
				[\gamma_1,\dots,\gamma_\ell] \in \Pi(\alpha,\ell)
				}
			}
			p\indices{_a_m^\alpha} \partial_{j_1 \cdots j_\ell}u^m (q^{(0)}_a)
      q\indices{_a^{j_1}_{\gamma_1}} \cdots
      q\indices{_a^{j_\ell}_{\gamma_\ell}}
			\right)
  \end{equation*}
  for arbitrary divergence free vector fields $u \in \mathfrak{X}_{\rm div}(\R^n)$.
  The right action of $\iso(z)$ yields the momentum map $J_R^{(k)}$ defined implicitly by the relation
  \begin{equation*}
    \langle J_R^{(k)}(q,p) , w \rangle = \sum_{a=1}^N
    \sum_{\substack{ |\alpha| \leq k \\ 1 \leq \ell \leq |\alpha| }} \;
		\sum_{
			\substack{
				j_1,\dots,j_\ell \in \{1,\dots,n\} \\
				[\gamma_1,\dots,\gamma_\ell] \in \Pi(\alpha,\ell)
				}
			}
			p\indices{_a_i^\alpha} q\indices{_a^{i}_{[j_1 \cdots j_\ell]}}
      \sum_{m=1}^\ell  \partial_{\gamma_m} w^{j_m}(z_a) \left( \prod_{n \neq m}  \delta_{\gamma_n}^{[j_n]} \right)
  \end{equation*}
  where $w \in \mathfrak{X}_{\rm div}(\R^n)$ is such that $w(z) = 0$ (this describes the Lie algebra of $\iso(z)$),
  and $\delta_\alpha^\beta$ is the natural generalization of the Kronecker-delta symbol to multi-indices.
  We can write these momentum maps explicitly, using the Dirac delta distribution, as
  \begin{multline*}
    J_L^{(k)}(q,p) =
    \sum_{a=1}^N \Bigg(
    p_{am} dx^m \otimes \delta_{q^{(0)}_a} \\
  + \sum_{\substack{ |\alpha| \leq k \\ 1 \leq \ell \leq |\alpha| }}
    (-1)^\ell p\indices{_{am}^\alpha} dx^m \otimes
      \sum_{\substack{
          j_1,\dots,j_\ell \in \{1,\dots,n\} \\
          [\gamma_1,\dots,\gamma_\ell] \in \Pi( \alpha,\ell)
          }
        }
      q\indices{_a^{j_1}_{\gamma_1}} \cdots q\indices{_a^{j_\ell}_{\gamma_\ell}}
      \partial_{j_1 \cdots j_\ell} \delta_{q^{(0)}_a}
      \Bigg)
  \end{multline*}
  and
  \begin{equation*}
    J_R^{(k)}(q,p) = \sum_{a=1}^{N}
    \sum_{\substack{ |\alpha| \leq k \\ 1 \leq \ell \leq |\alpha| }} \;
		\sum_{
			\substack{
				j_1,\dots,j_\ell \in \{1,\dots,n\} \\
				[\gamma_1,\dots,\gamma_\ell] \in \Pi(\alpha,\ell)
				}
			}
			p\indices{_a_i^\alpha} q\indices{_a^i_{[j_1 \cdots j_\ell]}}
      \sum_{m=1}^\ell (-1)^{|\gamma_m|}\left( \prod_{n \neq m}  \delta_{\gamma_n}^{[b_n]} \right) \otimes \partial_{\gamma_m}\delta_{z_a}
  \end{equation*}
  The action of $\SDiff(\R^n)$ is transitive on $Q_N^{(k)}$, and
  therefore transitive on the level sets of the momentum map $J_R^{(1)}$.
  By theorem \ref{thm:commuting_actions}, $J_L^{(k)}$ and $J_R^{(k)}$ form a dual pair.
  This gives us the final result on jetlet parametrized solutions.
  The proof is identical to that given in Proposition~\ref{prop:0-solutions}.
  \begin{prop}\label{prop:k-solutions}
    Let $p \ge \frac{n}{2} + k + 1$ and $\sigma > 0$.
    Then $H^{(k)} = h_{p,\sigma} \circ J_L^{(k)}$ is $C^1$.
        Let $(q,p)(t)$ be a solution to Hamilton's equations on 
        $T^*Q^{(k)}_N$, then $J_L^{(k)}( (q,p)(t))$ is a solution to Hamilton's
        equations on $\mathfrak{X}_{\rm div}(\R^n)^*$
        and $J_R^{(k)}( (q,p)(t))$ is constant in time.
  \end{prop}
  
  As before, an even richer family of velocity fields is generated by a single particle of this type.
  At order $k=2$ this yields four new varieties of velocity fields per particle.
  Two examples of such velocity fields are depicted in figure \ref{fig:2_jet}.
  
  \begin{figure}[h!]
  	\centering
	\includegraphics[width=0.4\textwidth]{./images/two_jet_a_2D.pdf}
	\includegraphics[width=0.4\textwidth]{./images/two_jet_b_2D.pdf}
	\caption{Some velocity fields generated by particles of order $k=2$.}
	\label{fig:2_jet}
  \end{figure}
  
  \subsection{Kelvin's circulation theorem}
  \label{sec:Kelvin}
  In this section we relate the conserved quantities associated
  to $J_R^{(k)}$ with Kelvin's circulation theorem.
Let $\varphi_t \in \SDiff(\R^n)$ denote the flow-map
produced by a solution to Euler's equation.
Let $\gamma(s,t) = \varphi_t(\gamma_0(s))$ for some loop $\gamma_0(s)$.
Kelvin's circulation theorem states that the circulation
\begin{equation}\label{eq:Kelvin-circulation}
  \Gamma(t) = \oint u( \gamma(s,t) )  \cdot \partial_s \gamma(s,t) ds
\end{equation}
is constant in time.
%\dm{In the interest of time I will not add an additional remark here for now. Maybe later, when we revise the paper.}
It was shown in \cite{Arnold1966} that this conservation law
is an instance of Noether's theorem.
In particular, circulation is one of the conserved momenta
associated to the particle relabeling symmetry of fluids.
More specifically,
recall that $h_0$ is the Hamiltonian for Euler's equations,
and this Hamiltonian is $\SDiff(\R^n)$ invariant. Moreover, we have a dual pair
$J_\text{spatial}: T^*\SDiff(\R^n) \to \mathfrak{X}_{\rm div}(\R^n)^*$
and $J_\text{conv}: T^*\SDiff(\R^n) \to \mathfrak{iso}(z)^*$ of
spatial and convective momentum maps induced by
the left action of $\SDiff(\R^n)$ and the right action of
$\iso(z) \subset \SDiff(\R^n)$ on $\SDiff(\R^n)$ itself.
By the general principles discussed earlier, the dynamics on $T^*\SDiff(\R^n)$ exhibits the constant of motion
\begin{equation}\label{eq:abstract-circulation}
  \langle J_\text{conv}(\varphi,p_\varphi) , w \rangle
  = \langle p_\varphi , T\varphi \cdot w \rangle
\end{equation}
for all $w \in \mathfrak{X}_{\rm div}(\R^n)$.  
This instance of Noether's theorem applies to regularized models as well as to the non-regularized case of Euler's.
In the case of Euler's fluid equations, the equivalence between the above conservation law
and Kelvin's circulation theorem is demonstrated by a heuristic
argument~\cite[Ch~1, Thm~5.5]{ArnoldKhesin1998}, which goes as follows. 
Consider a given closed curve $\gamma_0\colon S^1 \to \R^n$ and a family
of vector fields $w_\varepsilon$ such that $w_\varepsilon(\gamma(s)) = \gamma'(s)$
and such that the limit $w = \lim_{\varepsilon \to 0} w_\varepsilon$ is the discontinuous map
\begin{equation*}
  w(x) = \begin{cases}
    \gamma'_0(s) & \text{if $x = \gamma_0(s)$, for some $s$}\\
    0          & \text{else.}
  \end{cases}
\end{equation*}
Assuming $\epsilon$ is small and writing 
$p_\varphi = \langle \dot{\varphi} , \,\cdot\, \rangle_{L^2}$, we find
\begin{align*}
  \langle J_\text{conv}(\varphi,p_\varphi) , w_\varepsilon \rangle
  &= \langle \dot{\varphi} , T\varphi \cdot w_\varepsilon \rangle_{L^2}\\
  &= \int_{\mathbb{R}^n} \langle \dot{\varphi}(x) , \textrm{D}\varphi(x)\cdot w_\epsilon(x) \rangle_{\mathbb{R}^n} \,\textrm{d} x \\
  &\approx \oint \langle \dot{\varphi}(\gamma_0(s)) , \textrm{D}\varphi(\gamma_0(s))\cdot \gamma_0'(s) \rangle_{\mathbb{R}^n} \,\textrm{d} s \\
  &= \oint \langle u(\gamma(s,t)) , \partial_s \gamma(s,t) \rangle_{\mathbb{R}^n} \,\textrm{d} s,
\end{align*}
where $u = \dot{\varphi}\circ\varphi^{-1}$ is the usual Euler
representation of the fluid flow. 
\dm{I have four remarks about this: (i) AK98 Thm 5.5 looks, to me, like a statement of Kelvin's theorem, but it doesn't mention momentum maps etc...? (ii) I believe that in the limit as $\varepsilon$ goes to zero, the vector field $w$ should blow up in strength (ArnoldKhesin talk about unit flux through a transverse section to the curve).}
\hoj{
  (i)  I agree with the characterization of Thm5.5.  However, the point of this bit of text is that that the proof in AK98 uses $J_{\rm conv}$ to prove Kelvin's theorem (albeit using words).  The above provides a heuristic argument linking $J_{\rm conv}$ to circulation. Jaap and I thought we should give credit to AK98 for using this heuristic argument in the ``proof'' of Thm 5.5.  We could remove the citation if this seems too generous.
(ii) I do not agree.  I think this is a counter-example: $w_\epsilon(x) = \int_{S^1} K_\epsilon(x - \gamma(s) ) \gamma'(s) ds$ where $K_\epsilon$ is some incompressible matrix-kernel with length scale $\epsilon$.
}
Therefore, conservation of $J_{\rm conv}$ leads to conservation of circulation.

A more rigorous correspondence is developed in \cite{HolmMarsdenRatiu1998}.
Any $m \in \mathfrak{X}_{\rm div}(\R^n)^*$ can be written as a one-form density $\tilde{m} \otimes \mu$
where $\mu$ is the volume form on $\R^n$.
For any smooth curve $\gamma:S^1 \to \R^n$ we may consider the current
$\mathscr{K}(\gamma) \in \mathfrak{X}_{\rm div}(\R^n)^{**}$ defined by
\begin{align*}
	\langle \mathscr{K}(\gamma) , m \rangle = \int_{\gamma} \tilde{m}
\end{align*}
By Theorem 6.2 of \cite{HolmMarsdenRatiu1998}, if $\gamma_t(s) = \varphi_t(\gamma_0(s))$ and $m = \tilde{m} \otimes \mu$ satisfies
the ideal incompressible fluid equation (perhaps regularized), then the circulation
\begin{align*}
	\Gamma(t) = \langle \mathscr{K}(\gamma_t) , m(t) \rangle
\end{align*}
is constant in time.
It is in this sense that Kelvin's circulation theorem follows from the particle
relabeling symmetry for any $\SDiff(\R^n)$ invariant Lagrangian. 

In light of this discussion, it is natural to consider \eqref{eq:abstract-circulation} as the  fundamental conservation law. The main goal in the remainder of this section is to show that the jet-particle solutions satisfy conservation laws that are `shadows' of this fundamental law in the sense that they are associated with a \emph{partial} relabeling symmetry. To see this, it is useful to define the $k$-th order isotropy group,
$\iso^{(k)}(z) = \{ \psi \in \SDiff(\R^n) \mid \Jet^{k}_z( \psi) = \Jet^k_z (\rm{id})) \}$, where we wrote $\rm{id}$ for the identity mapping and $z$ is shorthand for $z_1, \ldots, z_N \in \mathbb{R}^n$.
Then we see that $Q^{(k)}_N = \SDiff(\R^n) / \iso^{(k)}(z)$, and the corresponding quotient map is given by $\Jet_z^k$.  
 The space $T^*Q^{(k)}$ naturally embeds into $T^*\SDiff(\R^n) / \iso^{(k)}(z)$.  The commutativity of the following diagram uniquely defines the jetlet solutions:
  \begin{equation}
 \begin{tikzcd}
   \mathfrak{X}_{\rm div}(\R^n)^* & \ar[l,"J_\text{spatial}"] T^*\SDiff(\R^n) \ar[r,"J_\text{conv}"] \ar[d,"\pi"] & \mathfrak{iso}(z)^* \\
   & T^*\SDiff(\R^n) / \iso^{(k)}(z) & \\
   & T^*Q^{(k)}_N \uar{i} \ar[uur,"J_R^{(k)}"',bend right = 30] \ar[uul,"J_L^{(k)}",bend left = 30] &
 \end{tikzcd}
\end{equation}
  Namely, for the left-hand part of the diagram recall that we have shown in the previous section that a jetlet solution has a velocity vector in $T \SDiff(\R^n)$ of the form \begin{align} v_{\varphi} = (K * J_L^{(k)}(p_q)) \circ \varphi \notag \end{align} for some $p_q \in T^*_q Q^{(k)}_N$, where $q = \Jet^k_z(\varphi)$. From this it follows that the corresponding Legendre momentum $p_\varphi$ satisfies, for all $ w \in \mathfrak{X}_{\rm div}(\R^n)$,
  \begin{align}
  \left< J_\text{spatial}(p_\varphi), w\right> = \left< p_\varphi, w \circ \varphi \right> = \left< J_L^{(k)}(p_q), w \right>, \notag
  \end{align}
  which shows commutativity of the left-hand part of the diagram. As for the right-hand part, we again use the special form of $p_\varphi$ to conclude that, for all $ w \in \mathfrak{iso}(z) \subset \mathfrak{X}_{\rm div}(\R^n)$,
 \begin{align}
 	\left<J_\text{conv}(p_\varphi), w\right> = \left<p_\varphi, T\varphi  (w) \right> = \left<J_L^{(k)}(p_q),  T\varphi (w \circ \varphi^{-1}) \right>. \label{compare_1}
 \end{align}
 On the other hand, if we write $\phi_\varphi: Q^{(k)}_N \to Q^{(k)}_N$ for the left action $\phi_\varphi (q) = \varphi \cdot q$, we have 
 \begin{align}
 	\left<J_R^{(k)}(p_q), w\right> = \left< p_q, T_{\phi_\varphi} (w_{Q^{(k)}_N} (q_0))   \right> =  \left<p_q, (T\varphi (w \circ \varphi^{-1}) )_{Q^{(k)}_N} (q) \right>, \notag \end{align}
 where we denoted the infinitesimal left action of $w$ on $Q^{(k)}_N$ by $w_{Q^{(k)}_N}$. The velocity corresponding (via the inverse of the Legendre transform) to $p_q$ can be written as $ T\Jet_z^k( (K * J_L^{(k)}(p_q)) \circ \varphi)$,
 and therefore one concludes that 
 \begin{align}
 	\left<J_R^{(k)}(p_q), w\right> = \left< J_L^{(k)}(p_q), T \varphi (w \circ \varphi^{-1}) \right>. \label{compare_2}
 \end{align}
 This shows the commutativity of the right-hand part of the  diagram above (compare \eqref{compare_1} and \eqref{compare_2}).
  
  Again, the right legs of both dual pairs yield the conserved quantities.
From the diagram it is clear that the conservation of $J_R^{(k)}$ exhibited in
our particle models is a shadow of the conservation of $J_\text{conv}$ in~\eqref{eq:abstract-circulation}.
Since $J_\text{conv}$ corresponds by Noether's theorem to the (large)
subgroup $\iso(z)$ of the right symmetry $\SDiff(\R^n)$ that generates
conservation of circulation, we see that conservation of $J_R^{(k)}$ in the jetlet solutions is a shadow
of the conservation of circulation.
In other words, our particle models contain a model of Kelvin's circulation theorem within them (cf.~\cite[Theorem 5.5]{JacobsRatiuDesbrun2013}).

As a side remark we mention that \eqref{compare_2} offers an alternative route to derive one momentum map once one has found the other. In contrast,  in the previous section we computed both $J_L^{(k)}$ and $J_R^{(k)}$ using the coordinate expressions, presented in the proof of proposition \ref{HL_action_prop},  for the respective actions on $Q^{(k)}_N$.


\section{Particle mergers}
\label{sec:collisions}

In this section we discuss some explicit dynamical behaviour of the
particle model, in particular we study `collisions' of jetlets. For
the zeroth order particles case, this was already analysed by Mumford
and Michor~\cite{MumfordMichor2013}, and they found that two
particles can merge in infinite time, or bounce off each other,
depending on the ratio of their relative angular and linear momenta.
To find the explicit behaviour analytically, we shall restrict to two
dimensional space and two $0$-jetlet particles with zero total linear
momentum. We identify the limiting merged state as a $1$-jetlet.
\je{still todo}

We start with the Hamiltonian $H^{(0)}$ for two $0$-jetlet particles,
\begin{equation}\label{eq:H-two-0jetlets}
  H = \frac{1}{2} \sum_{a,b=1}^2 p\indices{_a_i} K^{ij}(q_a - q_b) p\indices{_b_j}
\end{equation}
on $T^* \R^{2n}$ with the canonical Poisson brackets.
Translation symmetry allows us perform symplectic reduction. We switch
to a center of mass frame by choosing new coordinates
\begin{equation}\label{eq:CoM-coords}
  \bar{q} = q_1 + q_2, \qquad \tilde{q} = \frac{1}{2}(q_2 - q_1)
\end{equation}
with canonically associated momenta
\begin{equation*}
  \bar{p} = \frac{1}{2}(p_1 + p_2), \qquad \tilde{p} = p_2 - p_1.
\end{equation*}
The Hamiltonian in these cooordinates becomes
\begin{equation*}
  H =               \bar{p}_i \big( K^{ij}(0) + K^{ij}(2\tilde{q}) \big)   \bar{p}_j
     +\frac{1}{4} \tilde{p}_i \big( K^{ij}(0) - K^{ij}(2\tilde{q}) \big) \tilde{p}_j.
\end{equation*}
Since $\bar{q}$ is a cyclic variable and $\bar{p}$ conserved, we
find reduced equations of motion for $\tilde{q}$ and $\tilde{p}$:
\begin{equation}\label{eq:EoM-lin-reduced}
  \begin{aligned}
    \dot{\tilde{q}}^i &= \frac{1}{2}\big( K^{ij}(0) - K^{ij}(2\tilde{q}) \big) \tilde{p}_j, \\
    \dot{\tilde{p}}_i &= -2 \bar{p}_k \partial_i K^{kj}(2\tilde{q}) \bar{p}_j
                         +\frac{1}{2} \tilde{p}_k \partial_i K^{kj}(2\tilde{q}) \tilde{p}_j.
  \end{aligned}
\end{equation}
When $n = 2$ and the total momentum is zero, i.e.~$\bar{p} = 0$, we can perform
another symplectic reduction by rotational symmetry. We switch to
polar coordinates
\begin{equation}\label{eq:polar-coords}
  \tilde{q} = \big(r\cos(\varphi),r\sin(\varphi)\big)
\end{equation}
with canonically associated momenta
\begin{equation*}
  \tilde{p} =
  \begin{pmatrix}
    \cos(\varphi) & -\frac{\sin(\varphi)}{r} \\
    \sin(\varphi) &  \frac{\cos(\varphi)}{r}
  \end{pmatrix} \cdot
  \begin{pmatrix}
    p_r \\
    p_\varphi
  \end{pmatrix}
  = R_\varphi \cdot
  \begin{pmatrix}
    p_r \\
    \frac{p_\varphi}{r}
  \end{pmatrix},
\end{equation*}
where $R_\varphi$ is a rotation matrix. In these coordinates the
Hamiltonian is given by
\begin{equation*}
  \begin{aligned}
  H &= \frac{1}{4} \tilde{p}_i \big[ K^{ij}(0) - K^{ij}(2\tilde{q}) \big] \tilde{p}_j
     = \frac{1}{4} \begin{pmatrix} p_r \\ \frac{p_\varphi}{r} \end{pmatrix}^T R_\varphi^T
       \big[ K(0) - K(R_\varphi\cdot(2r,0)) \big] R_\varphi
       \begin{pmatrix} p_r \\ \frac{p_\varphi}{r} \end{pmatrix}\\
    &= \frac{1}{4} \begin{pmatrix} p_r \\ \frac{p_\varphi}{r} \end{pmatrix}^T
       \big[ K(0) - K(2r,0) \big] \begin{pmatrix} p_r \\ \frac{p_\varphi}{r} \end{pmatrix},
  \end{aligned}
\end{equation*}
where in the last step we used that $K$ as a tensor is invariant under
rotations. Since $\varphi$ is a cyclic variable, we find that its
associated momentum
\begin{equation*}
  p_\varphi = -r \sin(\varphi) \tilde{p}_1 + r \cos(\varphi) \tilde{p}_2
            = \tilde{q} \times \tilde{p}
\end{equation*}
is conserved. Remark that this relative angular momentum is not
exactly the total angular momentum when $\bar{p} \neq 0$.

Let us now choose the smooth kernel $K = K_{\infty,1}$ given
(up to a scaling factor) by
%
{\newcommand{\e}{e^{-\rho}}
\begin{equation}\label{eq:smooth-kernel}
  K^{ij}(x) = \Big(\e - \frac{1}{2\rho}\big(1 - \e\big)\Big)\delta^{ij}
    + \Big(\frac{1}{\rho}\big(1 - \e\big) - \e\Big)\frac{x^i x^j}{\|x\|^2},
\end{equation}%
}%
where $\rho := \frac{\|x\|^2}{2}$. Note that
$K^{ij}(0) = \frac{1}{2} \delta^{ij}$ and $\partial_k K^{ij}(0) = 0$.
Using rotational symmetry we set $\varphi = 0$, and obtain
\begin{equation}\label{eq:H-rot-reduced}
  H = \frac{p_r^2      }{8}   \Big(1 - \frac{1}{2r^2}\big(1-e^{-2r^2}\big)\Big)
     +\frac{p_\varphi^2}{8r^2}\Big(1 - 2e^{-2r^2} + \frac{1}{2r^2}\big(1-e^{-2r^2}\big)\Big).
\end{equation}
This system is Hamiltonian in $(r,p_r)$ with $p_\varphi$ a parameter, so
the level sets of $H$ determine the motion. For $p_\varphi = 0$ we see
that $H \propto p_r^2\, r^2 f(r^2)$ where $f$ is an analytic function
with $f(0) > 0$. Thus the level sets of $H$ near $r = 0$ look like
hyperbola with $p_r = 0$ and $r = 0$ as asymptotic axes, see
Figure~\eqref{fig:contour-J-zero}. Hence, two particles approaching
each other head-on will `collide' in infinite time; even though their
momentum blows up, their relative velocity decays exponentially.

If $p_\varphi \neq 0$ then the first non-constant contributing term has
sign opposite to the terms involving $p_r$, hence we see a new region
being created in Figure~\eqref{fig:contour-J-nonzero} where orbits
approach $r = 0$ and then `bounce off'. There are two asymptotic
orbits that approach the $r = 0$ axis at finite momentum; the limit
point can be calculated from the fact that $\dot{p}_r / \dot{r} = 0$
must hold there in the limit $r \to 0$. We find that
$p_r = \pm \sqrt{10/3}\,p_\varphi$. From
Figure~\ref{fig:contour-J-nonzero} it is clear that this is a good
approximation for the asymptotic curve.

\begin{figure}[ht]
  \centering
  \includegraphics[width=8cm]{Ham-contour-Jzero}
  \caption{A contour plot of the reduced
    Hamiltonian~\eqref{eq:H-rot-reduced} for $p_\varphi = 0$.}
  \label{fig:contour-J-zero}
\end{figure}
\begin{figure}[ht]
  \centering
  \includegraphics[width=8cm]{Ham-contour-Jnonzero}
  \caption{A contour plot of the reduced
    Hamiltonian~\eqref{eq:H-rot-reduced} for $p_\varphi = 0.2$. The red
    line shows the positive asymptotic value for merging or bouncing.}
  \label{fig:contour-J-nonzero}
\end{figure}



\section{Numerical experiments}
\label{sec:Numerical experiments}

We have performed a number of numerical simulations\footnote{%
  The simulation was written using Python and Numpy, the source code
  and generated videos can be found at:
  \url{https://github.com/hoj201/incompressible_jet_particles}%
} of these jetlet particles. These confirm that the conserved
quantities are indeed preserved and that two $0$-jetlet particles
merge as shown by the analysis in section~\ref{sec:collisions}.
Moreover, the merging behavior shows to be stable under perturbations
of initial conditions.

As basic experiment we take two $0$-jetlet particles with initial
states
\begin{equation}\label{eq:exp1-initial}
  \begin{alignedat}{2}
    q_1 &= (-3, 0), &\qquad& p_1 = ( 1.5,-d), \\
    q_2 &= ( 3, 0), &      & p_2 = (-1.5, d),
  \end{alignedat}
\end{equation}
aimed at each other with an offset parameter $d$. Furthermore, we use
$\sigma = 1$ throughout our experiments. The experiments show that for
$d = 0.27$ the two particles merge while spinning around each other,
while for $d = 0.288$ they get close, but then emerge from their close
spinning state and scatter in opposite directions. This confirms the
analytical value of $d = \sqrt{3/40} \approx 0.2739$ within reasonable
precision, noting that this is the asymptotic value for particles
starting close to each other.

Secondly, we performed a number of more complex simulations, all of
those being small perturbations of the basic experiment described
above. First, we added a small angular momentum `spin' component to
both particles, turning both into $1$-jetlets, one level higher in the
hierarchy. Then we added a third particle (both a $0$-jetlet and
$1$-jetlet) at such a distance and momentum that it exhibits medium
range interaction with the first two particles. Finally, we added a
small hyperbolic-like `stretching' momentum to the first particle
only. These configurations cannot be studied analytically anymore, but
the simulations show that the behavior observed in the basic
experiment persists. We can find parameter values of $d$ close to the
original one where the system shows a transition between the two
particles merging or scattering.

Finally, these experiments confirm the preservation of the conserved
quantities present in the system. For all experiments described above
we observed that the energy, total linear and angular momentum,
i.e.~$J_L$, as well as $J_R$ individually for each particle were
preserved with absolute errors less than $4 \cdot 10^{-4}$ over a time
of $60$ seconds, while the energy was of the order one. Unlike $J_R$
which is conserved for each particle, the $J_L$ momentum can be
exchanged between particles. Figure~\ref{fig:angmom-1jetlets} shows
the angular momentum of two scattering $1$-jetlets and
Figure~\ref{fig:angmom-3rd-jetlet} of two scattering $0$-jetlets
interacting weakly with a third jetlet particle.

\begin{figure}[htb]
  \centering
  \includegraphics[height=7cm]{angmom-1jetlets}
  \caption{Angular momentum exchange between two scattering $1$-jetlets.}
  \label{fig:angmom-1jetlets}
\end{figure}

\begin{figure}[htb]
  \centering
  \includegraphics[height=7cm]{angmom-3rd-jetlet}
  \caption{Angular momentum exchange between three jetlets.}
  \label{fig:angmom-3rd-jetlet}
\end{figure}

\appendix


\section{Hamiltonian mechanics}
\label{sec:Hamiltonian}
The goal of this section is to prove theorems \ref{thm:dual_pairs}
and \ref{thm:commuting_actions} (see pages \pageref{thm:dual_pairs} and \pageref{thm:commuting_actions}).
Those who understand and accept these theorems on a first reading
should be able to skip this section without any consequence.
Most of this section will be a crash course in Poisson geometry
and Hamiltonian mechanics as described in \cite{FOM,MandS,Weinstein1983}.

A typical introduction to Poisson structures in mechanics
begins by considering Hamilton's equations
\begin{align*}
  \dot{q} = \pder{H}{p} \quad, \quad  \dot{p} = - \pder{H}{q}.
\end{align*}
If we consider the two-form $dp \wedge dq$, then Hamilton's equations
can be written as $(\dot{q},\dot{p}) \lrcorner (dp \wedge dq) = dH(q,p)$.
This is the starting point for symplectic geometry, which
will be discussed in \S \ref{sec:Symplectic}.
Alternatively, these equations can be written using the bilinear map $\{ \cdot , \cdot \}_{\rm can} : C^1( T^*Q) \times C^1(T^*Q) \to C^0(T^*Q)$
given by
\begin{align*}
  \{ F , G \}_{\rm can} = \pder{F}{q}\pder{G}{p} - \pder{G}{q} \pder{G}{p}.
\end{align*}
In particular, we may write $\dot{q} = \{ q , H \}_{\rm can}$ and $\dot{p} = \{ p , H\}_{\rm can}$.
The object $\{ \cdot , \cdot \}_{\rm can}$ is a special case of more general
object known as a \emph{Poisson bracket} which will be introduced in
\S \ref{sec:Poisson}.

As a warning, symplectic geometry has developed greatly
since its origins in mechanics, and
has branched into an independent subfield of pure mathematics.
Many notions were revised and optimized in the $1970$'s and $1980$'s for
the purpose of proving theorems.
Occasionally these revisions entailed a sacrifice
in clarity, from the perspective of ``outsiders''.
This paper is intended to allow ``outsiders''
(such as ourselves) to reap the benefits of Poisson geometry.
Therefore, we will cut away as much abstraction as possible in this introductory
section.
Nonetheless, a minimal amount of abstraction is needed in order to
maintain mathematical rigour and stand firmly upon the shoulders of giants.

\subsection{Symplectic manifolds}
\label{sec:Symplectic}
We begin with the definition.
\begin{defn}
  Let $S$ be a manifold
  and let $\omega$ be a closed two-form on $S$ such that the map
  ``$v \in TS \mapsto \omega( v , \cdot ) \in T^*S$'' is weakly nondegenerate.\footnote{
    A linear map $L:V \to V^*$ is \emph{weakly nondegenerate} if $L$ is injective.  If $V$ is finite dimensional, this simply means that $L$ is invertible.}
  We call $\omega$ a \emph{symplectic form}.
  We call the pair $(S,\omega)$ a \emph{symplectic manifold}.
\end{defn}
All of the expressions derived in this article will be formal, and we refer to \cite{GayBalmazVizman2012}
for the functional analytic details of infinite dimensional symplectic manifolds.
As a first example, consider the manifold $\R^2$
with coordinates $(q,p)$.
The two-form $dq \wedge dp$ is a symplectic form.
Given a manifold $Q$,
the cotangent bundle $T^*Q$ has local fiber bundle coordinates
given by $(q^1,\dots, q^n,p_1,\dots,p_n)$ and there is a unique symplectic form
which is locally expressed by $dp^i \wedge dq_i$, where
a sum on repeated indices is assumed.
This local expression corresponds to a global symplectic
form on $T^*Q$, known as the \emph{canonical symplectic form}
and denoted $\omega_{\rm can}$ \cite[Theorem 3.2.10]{FOM}.
In fact, given any symplectic manifold $(S,\omega)$, the dimension of $S$
is even, and there exist local coordinates $(q^1,\dots,q^n,p_1,\dots,p_n)$
such that $\omega \stackrel{locally}{=} dp_i \wedge dq^i$.
This is known as \emph{Darboux's theorem} and we call these type of
coordinates \emph{Darboux coordinates}\cite[Theorem 3.2.2]{FOM}.

Given a function $H:S \to \mathbb{R}$,
the exterior derivative is the one-form $dH:S \to T^*S$
expressed in local coordinates by $dH(x) = \pder{H}{x^i} dx^i$.
The Hamiltonian vector field $X_H:S \to TS$ is the unique vector
field defined by the condition
$
  X_H \lrcorner \omega = dH.
$
The symbol ``$\lrcorner$'' is the operation of contraction between
the contravariant indices of $X_H$ and the first set of covariant
indices of $\omega$.
In Darboux coordinates, the Hamiltonian vector field induces the
equations of motion $\dot{q}^i = \pder{H}{p_i}$, $\dot{p}_i = \pder{H}{q^i}$.


An important aspect of study in Hamiltonian mechanics is that of symmetry.
This yields the following notions

\begin{defn}
  Let $G$ be a Lie group and let $\rho:G \to \Diff(S)$ be a group action on a symplectic manifold $(S,\omega)$.
  The group $G$ is said to \emph{act symplectically}
  \begin{align*}
    \omega( \rho( g ) \cdot v , \rho(g) \cdot w) = \omega(v,w)
  \end{align*}
  for any $g \in G, v,w \in T_xS$ and $x \in S$.
  If $\mathfrak{g}$ is the Lie algebra of such a group,
  the \emph{momentum map}, $J:S \to \mathfrak{g}^*$,
  is defined by the property
  \begin{align*}
    d \langle J , \xi \rangle = \xi_S \lrcorner \omega.
  \end{align*}
\end{defn}

Alternatively, we can characterize a momentum map $J: S \to \mathfrak{g}^*$, as the unique map such that $X_{\langle J , \xi \rangle} = \xi_S$ for any $\xi \in \mathfrak{g}$.
In the special case where $S = T^*Q$, a left/right action of $G$ on $Q$ can be lifted to a right/left symplectic action on $T^*Q$ given by
\begin{align*}
  (q,p) \in T^*Q \mapsto (g^{-1} \cdot q , g^* p) \in T^*Q.
\end{align*}
where $g^*p$ is the unique covector such that $\langle g^*p , v \rangle = \langle p , Tg \cdot v \rangle$.
In this case the momentum map is characterized by the condition
\begin{align}
  \langle J(q,p) , \xi \rangle = \langle p , \xi \cdot q \rangle.
  \label{eq:cotangent_momap}
\end{align}
This is contained in Theorem 12.1.4 of \cite{MandS}.

Finally, given two functions $f,h \in C^{\infty}(S)$ we can consider the function $\{ f,h\} = \omega( X_f, X_h)$.
In Darboux coordinates $\{ f , h \} = \pder{f}{q^i} \pder{h}{p_i} - \pder{f}{p_i} \pder{h}{q^i}$.
Hamilton's equations can then be written as $\dot{q}^i = \{ q^i , h \}$,
$\dot{p}_i = \{ p_i , h \}$.
We call $\{ \cdot , \cdot \}$ a Poisson bracket, and it is the subject of
the next subsection.

\subsection{Poisson manifolds}
\label{sec:Poisson}
We begin with the definition.

\begin{defn} \label{defn:Poisson}
  Let $P$ be a manifold, and $\{ \cdot , \cdot \}$ be a bilinear
  operation on $C^{\infty}(P)$ such that 
  $( C^{\infty}(P) , \{ \cdot , \cdot \} )$ is a Lie algebra
  and $\{ \cdot , h \}$ has the derivation property for any $h \in C^{\infty}(P)$.
  That is to say
  \begin{align*}
    \{ gf , h \} = \{ f , h \} \cdot g + \{ g , h \} \cdot f,
  \end{align*}
  for any $f,g,h \in C^{\infty}(P)$.
  We call $\{ \cdot , \cdot \}$ a \emph{Poisson bracket},
  and we call the pair $(P, \{ \cdot , \cdot \})$ a Poisson manifold.
\end{defn}

The first most important example of a Poisson bracket is
that of a Poisson bracket on a symplectic manifold $(S,\omega)$.
Here the Poisson bracket is $\{ f , g \} = \omega( X_f , X_g )$.
When $S$ is a cotangent bundle, and $\omega$ is the canonical
symplectic form, we call this bracket the \emph{canonical Poisson
bracket}.

The second most important example of a Poisson bracket,
after the canonical Poisson bracket,
is the Lie--Poisson bracket.  Let $\mathfrak{g}$ be a Lie algebra
and let $\mathfrak{g}^*$ denote it's dual.
The \emph{Lie--Poisson bracket} on $\mathfrak{g}^*$ is given 
by
\begin{align}
  \{ f , g \}_{\mathfrak{g}^*}( x ) = \pm
  \left \langle x , \left[ \pder{f}{x} , \pder{g}{x} \right] \right \rangle
  \label{eq:Lie-Poisson}
\end{align}
where $\langle \cdot , \cdot \rangle$ is the canonical pairing between
dual-vectors and vectors, and $[ \cdot , \cdot ]$ is the Lie bracket
on $\mathfrak{g}$.
The ``$+$'' Poisson bracket is nothing but the canonical Poisson bracket on $T^*G$,
mapped to the space $\mathfrak{g}^*$ via the left trivialization map $\lambda: (g,p) \in T^*G \mapsto (L_g)^*p \in \mathfrak{g}^*$.
The ``$-$'' bracket is obtained through the right trivialization map
$\rho:(g,p) \in T^*G \mapsto (R_g)^*p \in \mathfrak{g}^*$.
In the next sections we will derive this Poisson structure for the 
Lie algebras $\so(3)$ and $\mathfrak{X}(\mathbb{R}^n)$.


On a Poisson manifold $(P,\{ \cdot , \cdot \})$
the derivation property implies that the functional operator
$\{ \cdot , h \}$ is equivalent
to the Lie derivative operator of a unique vector field $X_h:P \to TP$.
That is to say, $X_h$ is the unique vector field such that $\lie_{X_h}[f] = \{ f , h \}$ for any $f \in C^1(P)$.
We call $X_h$ the \emph{Hamiltonian vector field} and the ODE $\dot{x} = X_h(x)$ is called a \emph{Hamiltonian equation}.
It is standard to write this ODE as ``$\dot{x} = \{ x , H\}$'',
despite the fact that one typically intends for ``$x$'' to represent
a point in $P$, and not a function.
Since one can take ``$x$'' to be a place-holder for a set of
local coordinate functions which determine $x$ uniquely, this
sloppiness is usually harmless.

\begin{prop}[Proposition 10.2.2 \cite{MandS}] \label{prop:Lie_hom}
  Let $(P,\{ \cdot , \cdot \})$ be a Poisson manifold.
  Then $X_{ \{ h ,f \} } = - [X_h , X_f ]$.
\end{prop}

\begin{cor} \label{cor:Lie_hom}
  Let $(S,\omega)$ be a symplectic manifold
  and let $h,f \in C^{\infty}(S)$.
  Then $[X_h , X_f] = -X_{\omega(X_h,X_f) }$.
\end{cor}
\begin{proof}
  $X_{\omega(X_h,X_f)} = X_{ \{h,f\} } = -[X_h , X_f]$.
\end{proof}

\begin{defn}
  Let $(P_1, \{ \cdot , \cdot \}_1)$ and $(P_2, \{ \cdot , \cdot \}_2)$
  be Poisson manifolds.
  A map $\psi:P_1 \to P_2$ is called a
  \emph{Poisson map} if $\{ f \circ \psi , g \circ \psi \}_1 = \{ f , g \}_2$  for any $f,g \in C^{\infty}(P_2)$.
\end{defn}


\begin{prop}[Lemma 1.2 of \cite{Weinstein1983} or Proposition 10.3.2 of \cite{MandS}] \label{prop:Poisson_dynamics}
  Let $\psi:P_1 \to P_2$ be a Poisson map.
  Let $h_2 \in C^2(P_2)$.
  If $x(t) \in P_1$ is a solution to Hamilton's equations with respect
  to $h_1 = h_2 \circ \psi \in C^2(P_1)$, then $y(t) = \psi(x(t)) \in P_2$ is a solution
  to Hamilton's equations with respect to $h_2$.
\end{prop}

  When the dimension of $P_2$ is larger than that of $P_1$,
  Proposition \ref{prop:Poisson_dynamics} allows one to find solutions of
  Hamiltonian equations on $P_2$
  by solving lower dimensional Hamiltonian equations
  on $P_1$.
  \subsection{Dual pairs}
  In this section we review the notion of dual pairs
  \cite{MarsdenWeinstein1983,Weinstein1983,GayBalmazVizman2012}.
  Let $(S,\omega)$ be a symplectic manifold.
  Given a distribution $V \subset TS$, denote the fiber over 
  $x \in S$ by $V_x \subset T_x S$.
  The \emph{symplectic orthogonal} to $V$ is the distribution
  \begin{align*}
    V^\omega = \{ w \in TS \mid \omega( w , v ) = 0, \forall v \in V \}.
  \end{align*}
  Let $\psi:S \to P_1$ be a Poisson map.
  The kernel of $\psi$ is the distribution
  \begin{align*}
    \kernel(\psi) = \{ v \in TS \mid T\psi \cdot v  = 0 \}.
  \end{align*}
  If $J:S \to P_2$ is a Poisson map as well, and
  \begin{align*}
    \kernel(J) = \kernel(\psi)^\omega
  \end{align*}
  we call the diagram
  \begin{align*}
    P_1 \stackrel{\psi}{\leftarrow} S \stackrel{J}{\to} P_2
  \end{align*}
  a \emph{dual pair}.
  In the case that $S$ is a cotangent bundle we call $\psi$ or $J$
  \emph{Clebsch variables} \cite{MarsdenWeinstein1983}.

  \begin{thm} \label{thm:dual_pairs}
    Let $J_1,J_2:S \to P_1,P_2$ form a dual pair.
    Let $h \in C^2(P_1)$.
    Let $(q,p)(t) \in S$ be a solution to Hamilton's equations
    with respect to the Hamiltonian $H = h \circ J_1$.
    Then $J_1\left( (q,p)(t) \right) \in P_1$ is a solution
    to Hamilton's equations on $P_1$ with respect to $h$,
    and $J_2( (q,p)(t))$ is constant in time.
  \end{thm}
  \begin{proof}
    Use proposition \ref{prop:Poisson_dynamics} to show that
    $x(t) = J_1 ((q,p)(t))$ is a solution to Hamilton's equations
    with respect to $h$.
    To verify that $J_2( (q,p)(t) )$ is constant,
    let $v \in \kernel(J_1)$ be a vector over $(q,p)(0) \in S$.
    This means that $v$ is tangent to the level set of $J_1$ at $(q,p)(0)$.
    Moreover, $H = h \circ J_1$ is constant on such level sets.
    Thus we observe
    \begin{align*}
      0 = \langle dH((q,p)(0)) , v \rangle =
      \omega \left( (\dot{q},\dot{p}) , v \right).
    \end{align*}
    As $v$ was an arbitrary element of $\kernel(J_1)$ over $(q,p)(0)$
    we see that $(\dot{q},\dot{p}) \in TS$ is contained
    in the symplectic orthogonal to $\kernel(J_1)$.
    Since $J_1$ and $J_2$ form a dual pair,
    this observation implies $(\dot{q},\dot{p}) \in \kernel(J_2)$.
    We may apply this argument at each time $t$ and observe
    \begin{align*}
      \frac{d}{dt} J_2( (q,p)(t)) = TJ_2 \cdot (\dot{q},\dot{p})(t)  
      = 0 \quad \forall t.
    \end{align*}
  \end{proof}
  
  The next theorem will be used later for the purpose of identifying
  dual pairs.
  
  \begin{thm}[example 2.2 of \cite{GayBalmazVizman2012}] \label{thm:commuting_actions}
    Let $G_1,G_2$ act symplectically on $(S,\omega)$
    by commuting group actions,
    $\rho_1$ and $\rho_2$.\footnote{
      This means 
      $\rho_1(g_1 , \rho_2 (x , g_2)) = \rho_2(\rho_1(g_1 , x) ,g_2)$
      for any $g_1 \in G_1, g_2 \in G_2$ and $x \in S$.}
    Moreover, assume $G_1$ acts transitively on the level sets of the momentum map $J_2$ associated with the  $G_2$-action.
    Then the momentum maps form the dual pair
    $
      \mathfrak{g}^*_1
      \stackrel{J_1}{\longmapsfrom}
      S
      \stackrel{J_2}{\longmapsto}
      \mathfrak{g}_2^*.
    $
  \end{thm}
  \begin{proof}
    Let us first show that $\kernel(J_1) = \rho_1(\mathfrak{g}_1 , S )^\omega$.
    Recall that $J_1$ is defined by the condition
    $d \langle J_1 , \xi_1 \rangle = i_{\rho_1(\xi_1)} \omega$
    where $\rho_1(\xi_1)$ is the infinitesimal generator of
    $\xi_1 \in \mathfrak{g}_1$.
    Let $v \in \rho_1(\mathfrak{g}_1,S)^\omega$.
    We observe that 
    $d \langle J_1 , \xi_1 \rangle (v) = \omega( \rho_1(\xi_1, x ), v ) = 0$.
    However $d\langle J_1 , \xi_1 \rangle (v) = \langle TJ_1(v) , \xi_1 \rangle$.
    Thus $v \in \kernel(J_1)$.
    The previous steps may be reversed, and
    the converse follows immediately.
    We find
    $\kernel(J_1) = \rho_1(\mathfrak{g}_1,S)^\omega$.
    Of course the same argument applies to $J_2$.

    We now show that $\kernel(J_2) = \rho_1(\mathfrak{g}_1,S)$.
    Let $\xi_1 \in \mathfrak{g}_1, \xi_2 \in \mathfrak{g}_2$.
    First note that $\rho_1(\xi_1) = X_{ \langle J_1 , \xi_1 \rangle}$,
    and the same calculation applies to $\xi_2$.
    Thus we observe by using Corollary~\ref{cor:Lie_hom} that
    \begin{align*}
      X_{ \omega( \rho_1(\xi_1) , \rho_2(\xi_2) ) }
      &= - [X_{ \langle J_1,\xi_1\rangle} , X_{\langle J_2,\xi_2\rangle} ] \\
      &= - [\rho_1(\xi_1) , \rho_2(\xi_2)] = 0.
    \end{align*}
    The final equality
    derives from the fact that the actions of $G_1$ and $G_2$ commute.
    We have proven that $\rho_1(\mathfrak{g}_1 , S)$ and $\rho_2(S,\mathfrak{g}_2)$ are
    symplectically orthogonal.
    Now note that
    $TJ_2 ( \xi_1 \cdot x) \cdot \xi_2 = \omega( \rho_1(\xi_1, x) ,\rho_2(x, \xi_2 )) = 0$.
    Thus $\rho_1(\xi_1 , x) \in \kernel( J_2)$, hence
    $\rho_1(\mathfrak{g}_1 ,S) \subset \kernel(J_2)$.
    But since $G_1$ acts transitively on the level sets of $J_2$, we see
    that $\rho_1(\mathfrak{g}_1, S) = \kernel( J_2)$.
  \end{proof}
  % With these foundations established, we proceed
  % to discuss a simple example of Poisson mechanics
  % before moving to the more sophisticated case
  % of fluids.



\section{Multi-indices}
\label{app:multi}
A multi-set is nothing but a set with some notion of multiplicity \cite{Blizard1989}.
In this paper, a multi-index on $\R^n$ is a multiset of elements derived from the generating set $\{1,\dots,n\}$.
Heuristically, a multi-index is just a ``bag of marbles'' each of which comes in $n$ ``colors''.
Given two multi-indices $\alpha \in \bag^i(n)$ and $\beta \in \bag^j(n)$ one can create the
multi-set union $\alpha \cup \beta \in \bag^{i+j}(n)$ by collecting the marbles of $\alpha$ and $\beta$ into a single bag.
Given integers $b_1,\dots,b_j \in \R^n$, we can define the unique multi-index $\beta = [b_1,\dots,b_j] \in \bag^j(n)$
obtained by collecting $b_1,\dots,b_j$ into a bag.
Given these conventions, we can denote the partial differential operator $\partial_{b_1 \cdots b_n }$ by $\partial_\beta$.
Moreover, the notion of equivalence of mixed partials is expressed by the equivalence 
$\partial_\alpha \partial_\beta = \partial_{\alpha \cup \beta} = \partial_\beta \partial_\alpha$.
The cardinality of the multi-index $\beta$ is denoted $|\beta|$ and is given by the number of marbles in the bag.
Thus the order of the partial differential operator $\partial_{\beta}$ is $|\beta|$.
We denote the space of $k$th order partitions of a multi-index by $\Pi(\alpha,k)$.
Rather than define all this formally, we will compute an example and refer to \cite{Jacobs2014b} for the formal definitions.

We can consider the integers $1$ $2$ and $1$, and the partial differential operator $\partial_{121}$.
The associated multi-index is just $[1,2,1]$.  This multi-index is equivalent to the multi-index $[1,1,2]$ and $[2,1,1]$.
We say that it contains the elements $1$ and $2$.
Because it contains `$1$' two times, we say that the multiplicity of $1$ is $2$.
The multiset of $2$-fold partitions is $\Pi( [1,2,1],2)$, and consists of three multiset-partitions
\begin{align*}
	[ [1] , [2,1] ] , [[1,1] , [2] ] , [ [1, 2] , [1] ].
\end{align*}
Note that the first and the third partition correspond to the same multiset.
The cardinality of $\Pi( [1,2,1],2)$ is $3$, although it only has two distinct elements (one with a multiplicity of $1$, and another with a multiplicity of $2$).

\section{The dual space of $\mathfrak{X}_{\rm div}(\R^n)$}
\label{sec:measure_valued_momap}
In this section we will provide a terse and incomplete
characterizations of the dual space of divergence free 
vector fields.  First let us characterize the dual space of the space of all vector fields (with ``proper'' decay).
Let $\mathfrak{X}(\R^n)$ be the space of vector fields which decay at infinity
in such a way that $\mathfrak{X}(\R^n)$ is Fr\'echet.
Viewing $\mathfrak{X}(\R^n)$ as a subspace of functions from $\R^n$ to $\R^n$
we can view it's dual as a space of distributions.
That is to say, given any $m \in \mathfrak{X}(\R^n)^*$ we may write $m$ as a tensor
product $p \otimes \mu$ where $\mu$ is a distribution (perhaps a measure)
on $\R^n$ and $p$ is a covector field (i.e. a one-form).
Conversely, given any $p \in \Omega^1(\R^n)$ and distribution $\mu \in \mathcal{D}(\R^n)$
we may form the tensor product $p \otimes \mu$.
The object $p\otimes \mu$ is identified as an element of $\mathfrak{X}(\R^n)^*$ through
the pairing
\begin{align*}
	\langle p \otimes \mu , u \rangle :=  \int_{\R^n} \langle p(x) , u(x) \rangle \mu.
\end{align*}
where $\langle p(x),u(x) \rangle$ is the function on $\R^n$ obtained by pairing the covector $p(x) \in T_x^*\R^n$ with the vector $u(x) \in T_x\R^n$.
If we restrict ourselves to the case of divergence free vector-fields, we need to quotient
the dual space appropriately.  In particular, we see that the annihilator of $\mathfrak{X}_{\rm div}(\R^n)$
as a subspace of $\mathfrak{X}(\R^n)$ is
\begin{align*}
	(\mathfrak{X}_{\rm div}(\R^n) )^\circ := \{ m \in \mathfrak{X}(\R^n)^* \mid \langle m , u \rangle = 0 , \forall u \in \mathfrak{X}_{\rm div}(\R^n) \}\\
		:= {\rm closure}\{ p \otimes d{\bf x} \in \mathfrak{X}(\R^n) \mid p \text{ is a closed one-form} \}.
\end{align*}
where $d{\bf x}$ is the canonical volume form on $\R^n$ and
we have used the fact that the gradient fields and the harmonic vector fields are $L^2$-orthogonal to the divergence free vector fields.
The dual space $\mathfrak{X}_{\rm div}(\R^n)^*$ is identical to the quotient space $\mathfrak{X}(\R^n) / (\mathfrak{X}_{\rm div}(\R^n))^\circ$.
In other words, we may view a $m \in \mathfrak{X}_{\rm div}(\R^n)^*$ as an object of the form $p \otimes \mu$ modulo $\mathfrak{X}_{\rm div}(\R^n)^\circ$.
In the text we will typically not mention $\mathfrak{X}_{\rm div}(\R^n)^\circ$ explicitly, and simply identify $m$ with $p \otimes \mu$.
This is a harmless identification as long as we don't pair it with a non-divergence free vector-field.

\section{Equations of motion for 2-jets}
\label{sec:eom}

\je{I haven't applied our index conventions here yet.}

The equations of motion are expressible as Hamiltonian
equations with respect to a non-canonical Poisson bracket.
If we denote $q^{(0)}$ by $q$ and $p^{(0)}$ 
by $p$ then the Hamiltonian is
\begin{align*}
  H(q,p,\mu^{(1)},\mu^{(2)}) =& \frac{1}{2} p_{i \alpha} p_{j \beta}
  K^{\alpha \beta}(q_i - q_j) - p_{i \alpha} [\mu^{(1)}_j]
  \indices{_{\beta}^{\gamma}} \partial_\gamma K^{\alpha \beta}( q_i -
  q_j) \\
  &+ p_{i \alpha} [\mu^{(2)}_j] \indices{_\beta^{\gamma
      \delta}} \partial_{\delta \gamma}K^{\alpha \beta}( q_i - q_j) -
  \frac{1}{2} [\mu_i^{(1)}] \indices{_{\alpha}^\delta} [\mu_j^{(1)} ]
  \indices{_\beta^\gamma} \partial_{\delta \gamma} K^{\alpha
    \beta}(q_i -q_j) \\
  &+ [\mu_i^{(1)}]\indices{_\alpha^\epsilon} [\mu_j^{(2)}]
  \indices{_\beta^{\gamma \delta}} \partial_{\epsilon \gamma \delta}
  K^{\alpha \beta}( q_i - q_j) \\
  &+ \frac{1}{2}
  [\mu_i^{(2)}]\indices{_\alpha^{\epsilon \phi}} [\mu_j^{(2)}]
  \indices{_\beta^{\gamma \delta} } \partial_{\gamma \delta \epsilon
    \phi} K^{\alpha \beta}( q_i - q_j )
\end{align*}
Where $K^{\alpha \beta}(x) = \delta^{\alpha \beta} e^{- \| x \|^2 / 2 \sigma^2}$.
Hamiton's equations are then given in short by
\begin{align}
  \dot{q} &= \frac{ \partial H}{\partial p} \label{eq:dHdp} \\
  \dot{p} &= - \frac{ \partial H}{\partial q} \label{eq:dHdq} \\
  \xi &= \frac{\partial H}{\partial \mu} \label{eq:dHdmu} \\
  \dot{\mu} &= - \ad^*_{ \xi } ( \mu ) . \label{eq:LiePoisson} 
\end{align}
More explicitly, equation \eqref{eq:dHdp} is given by
\begin{align*}
  \dot{q}_i^\alpha = p_{j \beta} K^{\alpha \beta}( q_i - q_j) -
  [\mu^{(1)}_j] \indices{_\beta^\gamma} \partial_\gamma K^{\alpha
    \beta}(q_i - q_j) + [\mu^{(2)}_j] \indices{_\beta^{\gamma
      \delta}} \partial_{\gamma \delta} K^{\alpha \beta}(q_i - q_j)
\end{align*}
equation \eqref{eq:dHdq} is given by the sum
\begin{align*}
  \dot{p}_{i\alpha} = T^{00}_{i\alpha} + T^{01}_{i\alpha} +
  T^{02}_{i\alpha} + T^{12}_{i\alpha} + T^{11}_{i\alpha} + T^{22}_{i\alpha}
\end{align*}

Where we define the six terms in this sum as
\begin{align*}
  T^{00}_{i\alpha} =& -p_{i\gamma}
  p_{j\beta} \partial_{\alpha}K^{\gamma\beta}(q_i - q_j) \\
  T^{01}_{i\alpha} =& (p_{i\delta} [\mu_j^{(1)}]\indices{_\beta^\gamma} -
  p_{j\delta}[\mu_i^{(1)}]\indices{_\beta^\gamma}) \partial_{\gamma\alpha}K^{\delta\beta}(q_i
  - q_j) \\
  T^{02}_{i\alpha} =& - (p_{i\epsilon}
  [\mu_j^{(2)}]\indices{_\beta^{\gamma\delta}} + p_{j\epsilon}
  [\mu_i^{(2)}] \indices{_\beta^{\gamma\delta}}
  ) \partial_{\gamma\delta\alpha}K^{\epsilon\beta}(q_i - q_j) \\
  T^{12}_{i\alpha} =& -([\mu_i^{(1)}] \indices{_\phi^\epsilon}
  [\mu_j^{(2)}]\indices{_\beta^{\gamma\delta}} -
  [\mu_j^{(1)}]\indices{_\phi^\epsilon} [\mu_i^{(2)}]
  \indices{_\beta^{\gamma\delta}}) \partial_{\epsilon\gamma\delta\alpha}K^{\phi\beta}(q_i
  - q_j) \\
  T^{11}_{i\alpha} =& [\mu_i^{(1)}] \indices{_\epsilon^\delta}
  [\mu_j^{(1)}]\indices{_\beta^\gamma} \partial_{\delta\gamma\alpha}
  K^{\epsilon\beta}(q_i - q_j) \\
  T^{22}_{i\alpha} =& -[\mu_i^{(2)}]\indices{_\zeta^{\epsilon\phi}}
  [\mu_j^{(2)}]\indices{_\beta^{\gamma\delta}} \partial_{\epsilon\delta\gamma\phi\alpha}
  K^{\zeta\beta}(q_i - q_j)
\end{align*}

Next, we calculate the quantities $\xi^{(i)} = \partial H / \partial \mu^{(i)}$
for $i=1,2$ of equation \eqref{eq:dHdmu} to be
\begin{align*}
  [\xi_i^{(1)} ]\indices{^\alpha_\beta} =&
  p_{j,\gamma} \partial_\beta K^{\alpha \gamma}(q_i - q_j) -
  [\mu_j^{(1)}]\indices{_{\delta}^{\gamma}} \partial_{\beta \gamma}
  K^{\alpha \delta}( q_i - q_j) +
  [\mu_j^{(2)}]\indices{_{\epsilon}^{\gamma \delta} }\partial_{\beta
    \gamma \delta} K^{\alpha
    \epsilon}(q_i - q_j) \\
  [\xi_i^{(2)}]\indices{^\alpha_{\beta \gamma}} =& p_{j
    \delta} \partial_{\beta \gamma}K^{\alpha \delta}(q_i - q_j) -
  [\mu_j^{(1)}]
  \indices{_\delta^\epsilon} \partial_{\epsilon\beta\gamma}K^{\alpha\delta}(q_i
  -q_j) + [\mu_j^{(2)}]\indices{_\epsilon^{\phi\delta}}\partial_{\beta\gamma\phi\delta}K^{\alpha\epsilon}(q_i-q_j)
\end{align*}
which allows us to compute $\dot{\mu}^{(i)}$ in equation \eqref{eq:LiePoisson} as
\begin{align*}
 [\dot{\mu}^{(1)}_i ]\indices{_\alpha^\beta} =&
 [\mu_i^{(1)}]\indices{_\alpha^\gamma}
 [\xi_i^{(1)}]\indices{^\beta_\gamma} -
 [\mu_i^{(1)}]\indices{_\gamma^\beta}
 [\xi_i^{(1)}]\indices{^\gamma_\alpha} \\
& + [\mu_i^{(2)}]\indices{_\alpha^{\delta \gamma}}
  [\xi_i^{(2)}]\indices{^\beta_{\delta \gamma}} 
- [\mu_i^{(2)}]\indices{_\delta^{\beta \gamma}}
  [\xi_i^{(2)}]\indices{^\delta_{\alpha \gamma}} 
- [\mu_i^{(2)}]\indices{_\delta^{\gamma \beta}}
  [\xi_i^{(2)}]\indices{^\delta_{\gamma \alpha}} \\
 [\dot{\mu_i}^{(2)}]\indices{_\alpha^{\beta \gamma}} =&
[\mu_i^{(2)}]\indices{_\alpha^{\delta \gamma}}
[\xi_i^{(1)}]\indices{^\beta_\delta} +
[\mu_i^{(2)}]\indices{_\alpha^{\beta \delta}}
[\xi_i^{(1)}]\indices{^\gamma_\delta} - [\mu_i^{(2)}]\indices{_\delta^{\beta \gamma}} [\xi_i^{(1)}]\indices{^\delta_\alpha}
\end{align*}


\subsection{Computing $\dot{q}$ as a function of $\xi$}
\label{sec:computing-dotq-as}

The action of $\xi$ on $q$ is given by $\xi \cdot q$.  We set $\dot{q}
= \xi \cdot q$. We've already calculated $\dot{q}^{(0)}$.
We need only calculate $\dot{q}^{(1)}$ and $\dot{q}^{(2)}$.
Componentwise we calculate these to be
\begin{align*}
  [\dot{q}^{(1)}]\indices{^\alpha_\beta} =&
  [\xi^{(1)}]\indices{^\alpha_\gamma} [q^{(1)}]\indices{^\gamma_\beta} \\
  [\dot{q}^{(2)}]\indices{^\alpha_{\beta \gamma} } =&
  [\xi^{(2)}]\indices{^\alpha_{\delta \epsilon}} \cdot 
  [q^{(1)}]\indices{^\delta_\beta} \cdot [q^{(1)}]\indices{^\epsilon_\gamma} + 
 [\xi^{(1)}]\indices{^\alpha_\delta} \cdot [q^{(2)}] \indices{^\delta_{\beta
     \gamma} }
\end{align*}

\dm{I have unified refs. Please conform with the conventions used if/when you add more references.}
\bibliographystyle{amsalpha}
\bibliography{hoj_2014}

\end{document}
